"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(){var t,i=ax5.ui,e=ax5.util;i.addClass({className:"grid",version:"0.2.0"},function(){var n=function(){var n,o=this;this.instanceId=ax5.getGuid(),this.config={theme:"default",animateTime:250,frozenColumnIndex:0,frozenRowIndex:0,showLineNumber:!1,showRowSelector:!1,multipleSelect:!1,height:0,columnMinWidth:100,lineNumberColumnWidth:30,rowSelectorColumnWidth:25,sortable:!1,header:{align:!1,columnHeight:25,columnPadding:3,columnBorderWidth:1},body:{align:!1,columnHeight:25,columnPadding:3,columnBorderWidth:1,grouping:!1},rightSum:!1,footSum:!1,page:{height:25,display:!0,navigationItemCount:5},scroller:{size:15,barMinSize:15},columnKeys:{selected:"_SELECTED"}},this.xvar={bodyTrHeight:0,scrollContentWidth:0,scrollContentHeight:0},this.columns=[],this.colGroup=[],this.footSumColumns=[],this.bodyGrouping={},this.list=[],this.page={},this.sortInfo={},this.focusedColumn={},this.selectedColumn={},this.isInlineEditing=!1,this.inlineEditing={},this.headerTable={},this.leftHeaderData={},this.headerData={},this.rightHeaderData={},this.bodyRowTable={},this.leftBodyRowData={},this.bodyRowData={},this.rightBodyRowData={},this.bodyRowMap={},this.bodyGroupingTable={},this.leftBodyGroupingData={},this.bodyGroupingData={},this.rightBodyGroupingData={},this.footSumTable={},this.leftFootSumData={},this.footSumData={},this.needToPaintSum=!0,n=this.config;var a=function(){var i={instanceId:this.id};return this.$target.html(t.tmpl.get("main",i)),this.$={container:{hidden:this.$target.find('[data-ax5grid-container="hidden"]'),root:this.$target.find('[data-ax5grid-container="root"]'),header:this.$target.find('[data-ax5grid-container="header"]'),body:this.$target.find('[data-ax5grid-container="body"]'),page:this.$target.find('[data-ax5grid-container="page"]'),scroller:this.$target.find('[data-ax5grid-container="scroller"]')},panel:{"aside-header":this.$target.find('[data-ax5grid-panel="aside-header"]'),"left-header":this.$target.find('[data-ax5grid-panel="left-header"]'),header:this.$target.find('[data-ax5grid-panel="header"]'),"header-scroll":this.$target.find('[data-ax5grid-panel-scroll="header"]'),"right-header":this.$target.find('[data-ax5grid-panel="right-header"]'),"top-aside-body":this.$target.find('[data-ax5grid-panel="top-aside-body"]'),"top-left-body":this.$target.find('[data-ax5grid-panel="top-left-body"]'),"top-body":this.$target.find('[data-ax5grid-panel="top-body"]'),"top-body-scroll":this.$target.find('[data-ax5grid-panel-scroll="top-body"]'),"top-right-body":this.$target.find('[data-ax5grid-panel="top-right-body"]'),"aside-body":this.$target.find('[data-ax5grid-panel="aside-body"]'),"aside-body-scroll":this.$target.find('[data-ax5grid-panel-scroll="aside-body"]'),"left-body":this.$target.find('[data-ax5grid-panel="left-body"]'),"left-body-scroll":this.$target.find('[data-ax5grid-panel-scroll="left-body"]'),body:this.$target.find('[data-ax5grid-panel="body"]'),"body-scroll":this.$target.find('[data-ax5grid-panel-scroll="body"]'),"right-body":this.$target.find('[data-ax5grid-panel="right-body"]'),"right-body-scroll":this.$target.find('[data-ax5grid-panel-scroll="right-body"]'),"bottom-aside-body":this.$target.find('[data-ax5grid-panel="bottom-aside-body"]'),"bottom-left-body":this.$target.find('[data-ax5grid-panel="bottom-left-body"]'),"bottom-body":this.$target.find('[data-ax5grid-panel="bottom-body"]'),"bottom-body-scroll":this.$target.find('[data-ax5grid-panel-scroll="bottom-body"]'),"bottom-right-body":this.$target.find('[data-ax5grid-panel="bottom-right-body"]')},livePanelKeys:[],scroller:{vertical:this.$target.find('[data-ax5grid-scroller="vertical"]'),"vertical-bar":this.$target.find('[data-ax5grid-scroller="vertical-bar"]'),horizontal:this.$target.find('[data-ax5grid-scroller="horizontal"]'),"horizontal-bar":this.$target.find('[data-ax5grid-scroller="horizontal-bar"]'),corner:this.$target.find('[data-ax5grid-scroller="corner"]')},page:{navigation:this.$target.find('[data-ax5grid-page="navigation"]'),status:this.$target.find('[data-ax5grid-page="status"]')},form:{clipboard:this.$target.find('[data-ax5grid-form="clipboard"]')},resizer:{vertical:this.$target.find('[data-ax5grid-resizer="vertical"]'),horizontal:this.$target.find('[data-ax5grid-resizer="horizontal"]')}},this.$.container.root.css({height:this.gridConfig.height}),this},l=function(i){this.columns=e.deepCopy(i),this.headerTable=t.util.makeHeaderTable.call(this,this.columns),this.xvar.frozenColumnIndex=n.frozenColumnIndex>this.columns.length?this.columns.length:n.frozenColumnIndex,this.bodyRowTable=t.util.makeBodyRowTable.call(this,this.columns),this.bodyRowMap=t.util.makeBodyRowMap.call(this,this.bodyRowTable),this.xvar.bodyTrHeight=this.bodyRowTable.rows.length*this.config.body.columnHeight;for(var o={},a=0,l=this.headerTable.rows.length;l>a;a++)for(var r=this.headerTable.rows[a],s=0,d=r.cols.length;d>s;s++)o[r.cols[s].colIndex]=jQuery.extend({},r.cols[s]);this.colGroup=[];for(var c in o)this.colGroup.push(o[c]);return this},r=function(){l.call(this,this.config.columns),s.call(this),this.config.footSum&&(d.call(this,this.config.footSum),this.needToPaintSum=!0),this.config.body.grouping&&c.call(this,this.config.body.grouping),h.call(this,!0),t.header.repaint.call(this,!0),t.body.repaint.call(this,!0),t.scroller.resize.call(this)},s=function(){var t,i,n,o=this.$.container.root.width(),a=0,l=[],r=this.colGroup;for(i=0,n=r.length;n>i;i++)e.isNumber(r[i].width)?a+=r[i]._width=r[i].width:"*"===r[i].width?l.push(i):"%"===e.right(r[i].width,1)&&(a+=r[i]._width=o*e.left(r[i].width,"%")/100);if(l.length>0)for(t=(o-a)/l.length,i=0,n=l.length;n>i;i++)r[l[i]]._width=t},d=function(i){e.isArray(i)?this.footSumTable=t.util.makeFootSumTable.call(this,this.footSumColumns=i):(this.footSumColumns=[],this.footSumTable={})},c=function(i){var e=jQuery.extend({},i);"by"in e&&"columns"in e?(this.bodyGrouping={by:e.by,columns:e.columns},this.bodyGroupingTable=t.util.makeBodyGroupingTable.call(this,this.bodyGrouping.columns),this.sortInfo=function(){for(var t={},i=0,e=this.bodyGrouping.by.length;e>i;i++){t[this.bodyGrouping.by[i]]={orderBy:"asc",seq:i,fixed:!0};for(var n=0,o=this.colGroup.length;o>n;n++)this.colGroup[n].key===this.bodyGrouping.by[i]&&(this.colGroup[n].sort="asc",this.colGroup[n].sortFixed=!0)}return t}.call(this)):n.body.grouping=!1},h=function(t){var i,e,o=this.$.container.root.width(),a=this.$.container.root.height(),l=o,r=a,s=n.asidePanelWidth=function(){var t=0;return n.showLineNumber&&(t+=n.lineNumberColumnWidth),n.showRowSelector&&(t+=n.rowSelectorColumnWidth),t}(),d=n.frozenPanelWidth=function(t,i){for(var e=0,n=0,o=i;o>n;n++)e+=t[n]._width;return e}(this.colGroup,n.frozenColumnIndex),c=0,h=function(t){return n.frozenRowIndex*t}(this.xvar.bodyTrHeight),u=function(t){return this.footSumColumns.length*t}.call(this,this.xvar.bodyTrHeight),g=this.headerTable.rows.length*n.header.columnHeight,f=n.page.display?n.page.height:0;(function(){i=a-g-f-u<this.list.length*this.xvar.bodyTrHeight?this.config.scroller.size:0,e=function(){for(var t=0,e=o-s-i,n=0,a=this.colGroup.length;a>n;n++)t+=this.colGroup[n]._width;return t>e?this.config.scroller.size:0}.call(this),e>0&&(i=a-g-f-u-e<this.list.length*this.xvar.bodyTrHeight?this.config.scroller.size:0)}).call(this),l=o-i,r=a-f-e;var x=r-g,p=function(t,i,e,o){var a={},r=!1;switch(e){case"aside":0===s?r=!0:(a.left=0,a.width=s);break;case"left":0===n.frozenColumnIndex?r=!0:(a.left=s,a.width=d);break;case"right":n.rightSum||(r=!0);break;default:"page"!==o&&(0===n.frozenColumnIndex?a.left=s:a.left=d+s,a.width=l-s-d-c)}if(r)return this;if("body"===o)switch(i){case"top":0==n.frozenRowIndex?r=!0:(a.top=0,a.height=h);break;case"bottom":n.footSum?(a.top=x-u,a.height=u):r=!0;break;default:a.top=h,a.height=x-h-u}else"header"===o?a.height=g:"page"===o&&(0==f?r=!0:a.height=f);return r?(t.hide(),this):(t.css(a),this)},m=function(t,i,e,n){var o={},a=!1;switch(n){case"vertical":i>0?(o.width=i,o.height=r,o.bottom=e+f):a=!0;break;case"horizontal":e>0?(o.width=l,o.height=e,o.right=i,o.bottom=f):a=!0;break;case"corner":i>0&&e>0?(o.width=i,o.height=e,o.bottom=f):a=!0}return a?(t.hide(),this):void t.show().css(o)};this.$.container.header.css({height:g}),this.$.container.body.css({height:x}),p.call(this,this.$.panel["aside-header"],"","aside","header"),p.call(this,this.$.panel["left-header"],"","left","header"),p.call(this,this.$.panel.header,"","","header"),p.call(this,this.$.panel["right-header"],"","right","header"),p.call(this,this.$.panel["top-aside-body"],"top","aside","body"),p.call(this,this.$.panel["top-left-body"],"top","left","body"),p.call(this,this.$.panel["top-body"],"top","","body"),p.call(this,this.$.panel["top-right-body"],"top","right","body"),p.call(this,this.$.panel["aside-body"],"","aside","body"),p.call(this,this.$.panel["left-body"],"","left","body"),p.call(this,this.$.panel.body,"","","body"),p.call(this,this.$.panel["right-body"],"","right","body"),p.call(this,this.$.panel["bottom-aside-body"],"bottom","aside","body"),p.call(this,this.$.panel["bottom-left-body"],"bottom","left","body"),p.call(this,this.$.panel["bottom-body"],"bottom","","body"),p.call(this,this.$.panel["bottom-right-body"],"bottom","right","body"),m.call(this,this.$.scroller.vertical,i,e,"vertical"),m.call(this,this.$.scroller.horizontal,i,e,"horizontal"),m.call(this,this.$.scroller.corner,i,e,"corner"),p.call(this,this.$.container.page,"","","page")},u=function(i){t.header.repaint.call(this),this.config.body.grouping?this.list=t.data.initData.call(this,t.data.sort.call(this,i,t.data.clearGroupingData.call(this,this.list))):this.list=t.data.sort.call(this,i,t.data.clearGroupingData.call(this,this.list)),t.body.repaint.call(this,!0),t.scroller.resize.call(this)};this.init=function(i){this.onStateChanged=n.onStateChanged,this.onClick=n.onClick;var r=this.gridConfig=jQuery.extend(!0,{},n,i);if(!r.target)return console.log(ax5.info.getError("ax5grid","401","init")),this;this.$target=jQuery(r.target),this.gridConfig.height||(this.gridConfig.height=this.$target.height()),this.id||(this.id=this.$target.data("data-ax5grid-id")),this.id||(this.id="ax5grid-"+ax5.getGuid(),this.$target.data("data-ax5grid-id",r.id)),function(t){e.isObject(t)&&!t.error&&(r=jQuery.extend(!0,r,t))}(e.parseJson(this.$target.attr("data-ax5grid-config"),!0)),a.call(this),l.call(this,r.columns),s.call(this),r.footSum&&d.call(this,r.footSum),r.body.grouping&&c.call(this,r.body.grouping),h.call(this,!0),t.header.init.call(this),t.header.repaint.call(this),t.body.init.call(this),t.body.repaint.call(this),t.scroller.init.call(this),t.scroller.resize.call(this),jQuery(window).bind("resize.ax5grid-"+this.instanceId,function(){h.call(this),t.scroller.resize.call(this)}.bind(this)),jQuery(document.body).on("click.ax5grid-"+this.instanceId,function(i){var n=e.findParentNode(i.target,{"data-ax5grid-container":"root"});n?o.focused=!0:(o.focused=!1,t.body.blur.call(o))});var u={33:"KEY_PAGEUP",34:"KEY_PAGEDOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_LEFT",38:"KEY_UP",39:"KEY_RIGHT",40:"KEY_DOWN"};return jQuery(window).on("keydown.ax5grid-"+this.instanceId,function(t){o.focused&&(t.metaKey||t.ctrlKey?67==t.which&&o.copySelect():o.isInlineEditing?t.which==ax5.info.eventKeys.ESC?o.keyDown("ESC",t.originalEvent):t.which==ax5.info.eventKeys.RETURN&&o.keyDown("RETURN",t.originalEvent):u[t.which]?o.keyDown(u[t.which],t.originalEvent):t.which==ax5.info.eventKeys.ESC||(t.which==ax5.info.eventKeys.RETURN?o.keyDown("RETURN",t.originalEvent):Object.keys(o.focusedColumn).length&&o.keyDown("INLINE_EDIT",t.originalEvent)))}),this},this.align=function(){return h.call(this),t.scroller.resize.call(this),this},this.keyDown=function(){var i={KEY_UP:function(){t.body.moveFocus.call(this,"UP")},KEY_DOWN:function(){t.body.moveFocus.call(this,"DOWN")},KEY_LEFT:function(){t.body.moveFocus.call(this,"LEFT")},KEY_RIGHT:function(){t.body.moveFocus.call(this,"RIGHT")},KEY_HOME:function(){t.body.moveFocus.call(this,"HOME")},KEY_END:function(){t.body.moveFocus.call(this,"END")},INLINE_EDIT:function(i){t.body.inlineEdit.active.call(this,this.focusedColumn,i),/[0-9a-zA-Z]/.test(i.key)||e.stopEvent(i)},ESC:function(i){t.body.inlineEdit.keydown.call(this,"ESC")},RETURN:function(i){t.body.inlineEdit.keydown.call(this,"RETURN")}};return function(t,e){return t in i&&i[t].call(this,e),this}}(),this.copySelect=function(){var t,i,e,n,o=this.$.form.clipboard,a=[],l="",r=0;for(var s in this.selectedColumn){var d=this.selectedColumn[s];if(d){"undefined"==typeof n&&(n=d.dindex,i=d.rowIndex,e=d.rowIndex),(n!=d.dindex||i!=d.rowIndex)&&r++,a[r]||(a[r]=[]);var c=this.bodyRowMap[d.rowIndex+"_"+d.colIndex];c?this.list[d.dindex].__isGrouping?a[r].push(this.list[d.dindex][d.colIndex]):a[r].push(this.list[d.dindex][c.key]):a[r].push(""),n=d.dindex,i=d.rowIndex}}a.forEach(function(t){l+=t.join("	")+"\n"}),o.get(0).innerText=l,o.select();try{t=document.execCommand("copy")}catch(h){t=!1}return t},this.setData=function(i){return t.data.set.call(this,i),h.call(this),t.body.repaint.call(this),t.scroller.resize.call(this),t.page.navigationUpdate.call(this),t.body.scrollTo.call(this,{top:0}),this},this.setHeight=function(i){return"100%"==i&&(i=this.$target.offsetParent().innerHeight()),this.$target.css({height:i}),this.$.container.root.css({height:i}),h.call(this),t.body.repaint.call(this,"reset"),t.scroller.resize.call(this),this},this.align=function(){return h.call(this),this},this.addRow=function(i,e){return t.data.add.call(this,i,e),h.call(this),t.body.repaint.call(this,"reset"),t.body.moveFocus.call(this,this.config.body.grouping?"START":"END"),t.scroller.resize.call(this),this},this.removeRow=function(i){return t.data.remove.call(this,i),h.call(this),t.body.repaint.call(this,"reset"),t.body.moveFocus.call(this,this.config.body.grouping?"START":"END"),t.scroller.resize.call(this),this},this.updateRow=function(i,e){return t.data.update.call(this,i,e),h.call(this),t.body.repaint.call(this,"reset"),t.body.moveFocus.call(this,this.config.body.grouping?"START":e),t.scroller.resize.call(this),this},this.addColumn=function(){var t={first:function(t){this.config.columns=[].concat(t).concat(this.config.columns)},last:function(t){this.config.columns=this.config.columns.concat([].concat(t))}};return function(i,n){if("undefined"==typeof i)throw"_column must not be null";if("undefined"==typeof n&&(n="last"),n in t)t[n].call(this,i);else{if(!e.isNumber(n))throw"invalid argument _cindex";this.config.columns.splice(n,[].concat(i))}return r.call(this),this}}(),this.removeColumn=function(){var t={first:function(t){this.config.columns.splice(t,1)},last:function(){this.config.columns.splice(this.config.columns.length-1,1)}};return function(i){if("undefined"==typeof i&&(i="last"),i in t)t[i].call(this,i);else{if(!e.isNumber(i))throw"invalid argument _cindex";this.config.columns.splice(i,1)}return r.call(this),this}}(),this.updateColumn=function(t,i){if(!e.isNumber(i))throw"invalid argument _cindex";return this.config.columns.splice(i,1,t),r.call(this),this},this.setColumnWidth=function(i,e){return this.colGroup[this.xvar.columnResizerIndex]._width=i,this.needToPaintSum=!0,t.header.repaint.call(this),t.body.repaint.call(this,!0),t.scroller.resize.call(this),h.call(this),this},this.getColumnSort=function(){return{}},this.setColumnSort=function(i){return"undefined"!=typeof i&&(this.sortInfo=i,t.header.applySortStatus.call(this,i)),u.call(this,i||this.sortInfo),this},this.select=function(i){if(e.isNumber(i)){var n=i;this.config.multipleSelect||(t.body.updateRowState.call(this,["selectedClear"]),t.data.clearSelect.call(this)),t.data.select.call(this,n),t.body.updateRowState.call(this,["selected"],n)}return this},this.main=function(){i.grid_instance=i.grid_instance||[],i.grid_instance.push(this),arguments&&e.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};return n}()),t=ax5.ui.grid}(),function(){var t=ax5.ui.grid,i=ax5.util,e={focusClear:function(){var t=this;for(var i in t.focusedColumn){var e=t.focusedColumn[i];e&&t.$.panel[e.panelName].find('[data-ax5grid-tr-data-index="'+e.dindex+'"]').find('[data-ax5grid-column-rowindex="'+e.rowIndex+'"][data-ax5grid-column-colindex="'+e.colIndex+'"]').removeAttr("data-ax5grid-column-focused")}t.focusedColumn={}},clear:function(){var t=this;for(var i in t.selectedColumn){var e=t.selectedColumn[i];e&&t.$.panel[e.panelName].find('[data-ax5grid-tr-data-index="'+e.dindex+'"]').find('[data-ax5grid-column-rowindex="'+e.rowIndex+'"][data-ax5grid-column-colindex="'+e.colIndex+'"]').removeAttr("data-ax5grid-column-selected")}t.selectedColumn={}},init:function(i){var n=this;return this.isInlineEditing&&this.inlineEditing.columnKey==i.dindex+"_"+i.colIndex+"_"+i.rowIndex?this:(e.focusClear.call(n),n.focusedColumn[i.dindex+"_"+i.colIndex+"_"+i.rowIndex]={panelName:i.panelName,dindex:i.dindex,rowIndex:i.rowIndex,colIndex:i.colIndex,colspan:i.colspan},e.clear.call(n),n.xvar.selectedRange={start:[i.dindex,i.rowIndex,i.colIndex,i.colspan-1],end:null},n.selectedColumn[i.dindex+"_"+i.colIndex+"_"+i.rowIndex]=function(t){return t?!1:{panelName:i.panelName,dindex:i.dindex,rowIndex:i.rowIndex,colIndex:i.colIndex,colspan:i.colspan}}(n.selectedColumn[i.dindex+"_"+i.colIndex+"_"+i.rowIndex]),this.$.panel[i.panelName].find('[data-ax5grid-tr-data-index="'+i.dindex+'"]').find('[data-ax5grid-column-rowindex="'+i.rowIndex+'"][data-ax5grid-column-colindex="'+i.colIndex+'"]').attr("data-ax5grid-column-focused","true").attr("data-ax5grid-column-selected","true"),void(this.isInlineEditing&&t.body.inlineEdit.deActive.call(this,"RETURN")))},update:function(t){var i,n,o,a,l=this;l.xvar.selectedRange.end=[t.dindex,t.rowIndex,t.colIndex,t.colspan-1],e.clear.call(l);var r={r:{s:Math.min(l.xvar.selectedRange.start[0],l.xvar.selectedRange.end[0]),e:Math.max(l.xvar.selectedRange.start[0],l.xvar.selectedRange.end[0])},c:{s:Math.min(l.xvar.selectedRange.start[2],l.xvar.selectedRange.end[2]),e:Math.max(l.xvar.selectedRange.start[2]+l.xvar.selectedRange.start[3],l.xvar.selectedRange.end[2]+l.xvar.selectedRange.end[3])}};for(i=r.r.s;i<=r.r.e;i++)for(a=this.bodyRowTable.rows.length,o=0;a>o;o++)for(n=r.c.s;n<=r.c.e;n++){var s=[],d="";l.xvar.frozenRowIndex>i&&s.push("top"),l.xvar.frozenColumnIndex>n&&s.push("left"),s.push("body"),"top"!==s[0]&&s.push("scroll"),d=s.join("-"),l.selectedColumn[i+"_"+n+"_"+o]={panelName:d,dindex:i,rowIndex:o,colIndex:n,colspan:t.colspan},s=null,d=null}i=null,n=null,o=null;for(var c in l.selectedColumn){var h=l.selectedColumn[c];h&&l.$.panel[h.panelName].find('[data-ax5grid-tr-data-index="'+h.dindex+'"]').find('[data-ax5grid-column-rowindex="'+h.rowIndex+'"][data-ax5grid-column-colindex="'+h.colIndex+'"]').attr("data-ax5grid-column-selected","true")}}},n={on:function(t){var i=this;e.init.call(i,t),this.$.container.body.on("mousemove.ax5grid-"+this.instanceId,'[data-ax5grid-column-attr="default"]',function(){this.getAttribute("data-ax5grid-column-rowIndex")&&e.update.call(i,{panelName:this.getAttribute("data-ax5grid-panel-name"),dindex:Number(this.getAttribute("data-ax5grid-data-index")),rowIndex:Number(this.getAttribute("data-ax5grid-column-rowIndex")),colIndex:Number(this.getAttribute("data-ax5grid-column-colIndex")),colspan:Number(this.getAttribute("colspan"))})}).on("mouseup.ax5grid-"+this.instanceId,function(){n.off.call(i)}).on("mouseleave.ax5grid-"+this.instanceId,function(){n.off.call(i)}),jQuery(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(){this.$.container.body.off("mousemove.ax5grid-"+this.instanceId).off("mouseup.ax5grid-"+this.instanceId).off("mouseleave.ax5grid-"+this.instanceId),jQuery(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},o=function(t,i,e){var n=this,o=this.config,a={selected:function(t){for(var i=this.$.livePanelKeys.length;i--;)this.$.panel[this.$.livePanelKeys[i]].find('[data-ax5grid-tr-data-index="'+t+'"]').attr("data-ax5grid-selected",this.list[t][o.columnKeys.selected])},selectedClear:function(){for(var t=this.selectedDataIndexs.length;t--;)for(var i=this.selectedDataIndexs[t],e=this.$.livePanelKeys.length;e--;)this.$.panel[this.$.livePanelKeys[e]].find('[data-ax5grid-tr-data-index="'+i+'"]').attr("data-ax5grid-selected",!1),this.list[i][o.columnKeys.selected]=!1},cellChecked:function(t,i){var e=i.key,n=i.rowIndex,o=i.colIndex,a=function(){var i=[];return this.xvar.frozenRowIndex>t&&i.push("top"),this.xvar.frozenColumnIndex>o&&i.push("left"),i.push("body"),"top"!==i[0]&&i.push("scroll"),i.join("-")}.call(this);this.$.panel[a].find('[data-ax5grid-tr-data-index="'+t+'"]').find('[data-ax5grid-column-rowIndex="'+n+'"][data-ax5grid-column-colIndex="'+o+'"]').find('[data-ax5grid-editor="checkbox"]').attr("data-ax5grid-checked",""+this.list[t][e])}};t.forEach(function(t){if(!a[t])throw"invaild state name";a[t].call(n,i,e)})},a=function(){var e=this;this.$.container.body.on("click","[data-ax5grid-column-attr]",function(){var i,n,a,l,r,s,d,c={"default":function(i){var n=e.bodyRowMap[i.rowIndex+"_"+i.colIndex],a={self:e,page:e.page,list:e.list,dindex:i.dindex,rowIndex:i.rowIndex,colIndex:i.colIndex,column:n,value:e.list[i.dindex][n.key]};if(n.editor&&"checkbox"==n.editor.type){var l=e.list[i.dindex][n.key],r=0==l||"false"==l||"1">l?"true":"false";t.data.setValue.call(e,i.dindex,n.key,r),o.call(e,["cellChecked"],i.dindex,{key:n.key,rowIndex:i.rowIndex,colIndex:i.colIndex})}else e.config.body.onClick&&e.config.body.onClick.call(a)},rowSelector:function(i){t.data.select.call(e,i.dindex),o.call(e,["selected"],i.dindex)},lineNumber:function(t){}};i=this.getAttribute("data-ax5grid-panel-name"),n=this.getAttribute("data-ax5grid-column-attr"),a=Number(this.getAttribute("data-ax5grid-column-row")),l=Number(this.getAttribute("data-ax5grid-column-col")),s=Number(this.getAttribute("data-ax5grid-column-rowIndex")),d=Number(this.getAttribute("data-ax5grid-column-colIndex")),r=Number(this.getAttribute("data-ax5grid-data-index")),n in c&&c[n]({panelName:i,attr:n,row:a,col:l,dindex:r,rowIndex:s,colIndex:d})}),this.$.container.body.on("dblclick","[data-ax5grid-column-attr]",function(i){var n,o,a,l,r,s,d,c={"default":function(n){if(this.isInlineEditing&&this.inlineEditing.columnKey==n.dindex+"_"+n.colIndex+"_"+n.rowIndex)return this;var o=e.bodyRowMap[n.rowIndex+"_"+n.colIndex],a="";o&&(e.list[r].__isGrouping||(a=e.list[r][o.key])),t.body.inlineEdit.active.call(e,e.focusedColumn,i,a)},rowSelector:function(t){},lineNumber:function(t){}};n=this.getAttribute("data-ax5grid-panel-name"),o=this.getAttribute("data-ax5grid-column-attr"),a=Number(this.getAttribute("data-ax5grid-column-row")),l=Number(this.getAttribute("data-ax5grid-column-col")),s=Number(this.getAttribute("data-ax5grid-column-rowIndex")),d=Number(this.getAttribute("data-ax5grid-column-colIndex")),r=Number(this.getAttribute("data-ax5grid-data-index")),o in c&&c[o]({panelName:n,attr:o,row:a,col:l,dindex:r,rowIndex:s,colIndex:d})}),this.$.container.body.on("mouseover","tr",function(){return}),this.$.container.body.on("mousedown",'[data-ax5grid-column-attr="default"]',function(t){this.getAttribute("data-ax5grid-column-rowIndex")&&n.on.call(e,{panelName:this.getAttribute("data-ax5grid-panel-name"),dindex:Number(this.getAttribute("data-ax5grid-data-index")),rowIndex:Number(this.getAttribute("data-ax5grid-column-rowIndex")),colIndex:Number(this.getAttribute("data-ax5grid-column-colIndex")),colspan:Number(this.getAttribute("colspan"))})}).on("dragstart",function(t){return i.stopEvent(t),!1}),l.call(this)},l=function(){var i=this.config,e=t.util.divideTableByFrozenColumnIndex(this.bodyRowTable,this.xvar.frozenColumnIndex);if(this.asideBodyRowData=function(t){for(var e={rows:[]},n=0,o=t.rows.length;o>n;n++)if(e.rows[n]={cols:[]},0===n){var a={label:"",colspan:1,rowspan:t.rows.length,colIndex:null},l={};i.showLineNumber&&(l=jQuery.extend({},a,{width:i.lineNumberColumnWidth,_width:i.lineNumberColumnWidth,columnAttr:"lineNumber",label:"&nbsp;",key:"__d-index__"}),e.rows[n].cols.push(l)),i.showRowSelector&&(l=jQuery.extend({},a,{width:i.rowSelectorColumnWidth,_width:i.rowSelectorColumnWidth,columnAttr:"rowSelector",label:"",key:"__d-checkbox__"}),e.rows[n].cols.push(l))}return e}.call(this,this.bodyRowTable),this.leftBodyRowData=e.leftData,this.bodyRowData=e.rightData,i.body.grouping){var n=t.util.divideTableByFrozenColumnIndex(this.bodyGroupingTable,this.xvar.frozenColumnIndex);this.asideBodyGroupingData=function(t){for(var e={rows:[]},n=0,o=t.rows.length;o>n;n++)if(e.rows[n]={cols:[]},0===n){var a={label:"",colspan:1,rowspan:t.rows.length,colIndex:null},l={};i.showLineNumber&&(l=jQuery.extend({},a,{width:i.lineNumberColumnWidth,_width:i.lineNumberColumnWidth,columnAttr:"lineNumber",label:"&nbsp;",key:"__d-index__"}),e.rows[n].cols.push(l)),i.showRowSelector&&(l=jQuery.extend({},a,{width:i.rowSelectorColumnWidth,_width:i.rowSelectorColumnWidth,columnAttr:"rowSelector",label:"",key:"__d-checkbox__"}),e.rows[n].cols.push(l))}return e}.call(this,this.bodyGroupingTable),this.leftBodyGroupingData=n.leftData,this.bodyGroupingData=n.rightData}if(this.leftFootSumData={},this.footSumData={},this.config.footSum){var o=t.util.divideTableByFrozenColumnIndex(this.footSumTable,this.xvar.frozenColumnIndex);this.leftFootSumData=o.leftData,this.footSumData=o.rightData}},r=function(e,n,o,a,l){var r=a.key;if("__d-index__"===r)return o+1;if("__d-checkbox__"===r)return'<div class="checkBox"></div>';if(a.editor&&function(i){return i.type in t.inlineEditor?"inline"==t.inlineEditor[i.type].editMode:!1}(a.editor))return t.inlineEditor[a.editor.type].getHtml(this,a.editor,l||n[r]);if(a.formatter){var s={key:r,value:l||n[r],index:o,item:n,list:e};return i.isFunction(a.formatter)?a.formatter.call(s):t.formatter[a.formatter].call(s)}return l||n[r]||"&nbsp;"},s=function(e,n,o){var a,l,r=o.key,s=o.label;return"undefined"==typeof r?(l={key:r,list:e.__groupingList,groupBy:e.__groupingBy},a=i.isFunction(s)?s.call(l):s,e[o.colIndex]=a,a):"__d-index__"===r?n+1:"__d-checkbox__"===r?"&nbsp;":o.collector?(l={key:r,list:e.__groupingList},a=i.isFunction(o.collector)?o.collector.call(l):t.collector[o.collector].call(l),e[o.colIndex]=a,o.formatter?(l.value=a,i.isFunction(o.formatter)?o.collector.call(l):t.formatter[o.formatter].call(l)):a):"&nbsp;"},d=function(e,n){var o=n.key,a=n.label;if("undefined"==typeof o)return a;if("__d-index__"===o||"__d-checkbox__"===o)return"&nbsp;";if(n.collector){var l,r={key:o,list:e};return l=i.isFunction(n.collector)?n.collector.call(r):t.collector[n.collector].call(r),n.formatter?(r.value=l,i.isFunction(n.formatter)?n.collector.call(r):t.formatter[n.formatter].call(r)):l}return"&nbsp;"},c=function(e){var n=this.config,o=this.list;e&&(l.call(this),this.xvar.paintStartRowIndex=void 0);var a=Math.floor(Math.abs(this.$.panel["body-scroll"].position().top)/this.xvar.bodyTrHeight)+this.xvar.frozenRowIndex;if(this.xvar.dataRowCount===o.length&&this.xvar.paintStartRowIndex===a)return this;var c="undefined"==typeof this.xvar.paintStartRowIndex,h=this.asideBodyRowData,u=this.leftBodyRowData,g=this.bodyRowData,f=this.leftFootSumData,x=this.footSumData,p=this.asideBodyGroupingData,m=this.leftBodyGroupingData,v=this.bodyGroupingData,b=n.body.align,y=Math.ceil(this.$.panel.body.height()/this.xvar.bodyTrHeight)+1;this.xvar.scrollContentHeight=this.xvar.bodyTrHeight*(this.list.length-this.xvar.frozenRowIndex),this.$.livePanelKeys=[];var w=function(t,e,o,a,l,d){var h=this.$.panel[t];if(!c&&!d)return this.$.livePanelKeys.push(t),!1;var u,g,f,x,p,m,v,y,w,I,_,C=[],$=function(){return"undefined"==typeof d||"undefined"==typeof d.paintStartRowIndex?(d={paintStartRowIndex:0,paintRowCount:l.length},!1):!0}();for(C.push('<table border="0" cellpadding="0" cellspacing="0">'),C.push("<colgroup>"),u=0,g=e.length;g>u;u++)C.push('<col style="width:'+e[u]._width+'px;"  />');for(C.push("<col  />"),C.push("</colgroup>"),f=d.paintStartRowIndex,x=function(){var t;return t=l.length,d.paintRowCount+d.paintStartRowIndex<t&&(t=d.paintRowCount+d.paintStartRowIndex),t}();x>f;f++){var R,z=!1;a&&"__isGrouping"in l[f]?(R=a,z=!0):R=o;for(p=0,m=R.rows.length;m>p;p++){for(C.push('<tr class="tr-'+f%4+'"',z?' data-ax5grid-grouping-tr="true"':"",' data-ax5grid-tr-data-index="'+f+'"',' data-ax5grid-selected="'+(l[f][n.columnKeys.selected]||"false")+'">'),v=0,y=R.rows[p].cols.length;y>v;v++)w=R.rows[p].cols[v],I=n.body.columnHeight*w.rowspan-n.body.columnBorderWidth,_=w.align||b,C.push("<td ",'data-ax5grid-panel-name="'+t+'" ','data-ax5grid-data-index="'+f+'" ','data-ax5grid-column-row="'+p+'" ','data-ax5grid-column-col="'+v+'" ','data-ax5grid-column-rowIndex="'+w.rowIndex+'" ','data-ax5grid-column-colIndex="'+w.colIndex+'" ','data-ax5grid-column-attr="'+(w.columnAttr||"default")+'" ',function(t,i){var e="";return t&&(e+='data-ax5grid-column-focused="true" '),i&&(e+='data-ax5grid-column-selected="true" '),e}(this.focusedColumn[f+"_"+w.colIndex+"_"+w.rowIndex],this.selectedColumn[f+"_"+w.colIndex+"_"+w.rowIndex]),'colspan="'+w.colspan+'" ','rowspan="'+w.rowspan+'" ','class="'+function(t){var e="";return t.styleClass&&(e+=i.isFunction(t.styleClass)?t.styleClass.call({column:t,key:t.key,item:l[f],index:f})+" ":t.styleClass+" "),n.body.columnBorderWidth&&(e+="hasBorder "),v==y-1&&(e+="isLastColumn "),e}.call(this,w)+'" ','style="height: '+I+'px;min-height: 1px;">'),C.push(function(t){var i=n.body.columnHeight-2*n.body.columnPadding-n.body.columnBorderWidth;return w.multiLine||(t=n.body.columnHeight-n.body.columnBorderWidth),'<span data-ax5grid-cellHolder="'+(w.multiLine?"multiLine":"")+'" '+(_?'data-ax5grid-text-align="'+_+'"':"")+'" style="height:'+t+"px;line-height: "+i+'px;">'}(I),z?s.call(this,l[f],f,w):r.call(this,l,l[f],f,w),"</span>"),C.push("</td>");C.push("<td ",'data-ax5grid-column-row="null" ','data-ax5grid-column-col="null" ','data-ax5grid-data-index="'+f+'" ','data-ax5grid-column-attr="default" ','style="height: '+n.body.columnHeight+'px;min-height: 1px;" ',"></td>"),C.push("</tr>")}}return C.push("</table>"),$&&h.css({paddingTop:(d.paintStartRowIndex-this.xvar.frozenRowIndex)*d.bodyTrHeight}),h.html(C.join("")),this.$.livePanelKeys.push(t),!0},I=function(t,e,o,a,l){var r=this.$.panel[t];if(!c&&!l)return this.$.livePanelKeys.push(t),!1;var s,h,u,g,f,x,p,m,v,y=[];for(y.push('<table border="0" cellpadding="0" cellspacing="0">'),y.push("<colgroup>"),s=0,h=e.length;h>s;s++)y.push('<col style="width:'+e[s]._width+'px;"  />');for(y.push("<col  />"),y.push("</colgroup>"),u=0,g=o.rows.length;g>u;u++){for(y.push('<tr class="tr-sum">'),f=0,x=o.rows[u].cols.length;x>f;f++)p=o.rows[u].cols[f],m=n.body.columnHeight*p.rowspan-n.body.columnBorderWidth,v=p.align||b,y.push("<td ",'data-ax5grid-panel-name="'+t+'" ','data-ax5grid-column-row="'+u+'" ','data-ax5grid-column-col="'+f+'" ','data-ax5grid-column-rowIndex="'+u+'" ','data-ax5grid-column-colIndex="'+p.colIndex+'" ','data-ax5grid-column-attr="'+(p.columnAttr||"sum")+'" ',function(t,i){var e="";return t&&(e+='data-ax5grid-column-focused="true" '),i&&(e+='data-ax5grid-column-selected="true" '),e}(this.focusedColumn["sum_"+p.colIndex+"_"+u],this.selectedColumn["sum_"+p.colIndex+"_"+u]),'colspan="'+p.colspan+'" ','rowspan="'+p.rowspan+'" ','class="'+function(t){var e="";return t.styleClass&&(e+=i.isFunction(t.styleClass)?t.styleClass.call({column:t,key:t.key,isFootSum:!0})+" ":t.styleClass+" "),n.body.columnBorderWidth&&(e+="hasBorder "),f==x-1&&(e+="isLastColumn "),e}.call(this,p)+'" ','style="height: '+m+'px;min-height: 1px;">'),y.push(function(t){var i=n.body.columnHeight-2*n.body.columnPadding-n.body.columnBorderWidth;return p.multiLine||(t=n.body.columnHeight-n.body.columnBorderWidth),'<span data-ax5grid-cellHolder="'+(p.multiLine?"multiLine":"")+'" '+(v?'data-ax5grid-text-align="'+v+'"':"")+'" style="height:'+t+"px;line-height: "+i+'px;">'}(m),d.call(this,a,p),"</span>"),y.push("</td>");
y.push("<td ",'data-ax5grid-column-row="null" ','data-ax5grid-column-col="null" ','data-ax5grid-column-attr="sum" ','style="height: '+n.body.columnHeight+'px;min-height: 1px;" ',"></td>"),y.push("</tr>")}return y.push("</table>"),r.html(y.join("")),this.$.livePanelKeys.push(t),!0},_={paintStartRowIndex:a,paintRowCount:y,bodyTrHeight:this.xvar.bodyTrHeight};n.asidePanelWidth>0&&(this.xvar.frozenRowIndex>0&&w.call(this,"top-aside-body",this.asideColGroup,h,p,o.slice(0,this.xvar.frozenRowIndex)),w.call(this,"aside-body-scroll",this.asideColGroup,h,p,o,_),n.footSum),this.xvar.frozenColumnIndex>0&&(this.xvar.frozenRowIndex>0&&w.call(this,"top-left-body",this.leftHeaderColGroup,u,m,o.slice(0,this.xvar.frozenRowIndex)),w.call(this,"left-body-scroll",this.leftHeaderColGroup,u,m,o,_),n.footSum&&this.needToPaintSum&&I.call(this,"bottom-left-body",this.leftHeaderColGroup,f,o)),this.xvar.frozenRowIndex>0&&w.call(this,"top-body-scroll",this.headerColGroup,g,v,o.slice(0,this.xvar.frozenRowIndex)),w.call(this,"body-scroll",this.headerColGroup,g,v,o,_),n.footSum&&this.needToPaintSum&&I.call(this,"bottom-body-scroll",this.headerColGroup,x,o,_),n.rightSum,this.xvar.paintStartRowIndex=a,this.xvar.paintRowCount=y,this.xvar.dataRowCount=o.length,this.needToPaintSum=!1,t.page.statusUpdate.call(this)},h=function(t,i){var e=this.config;e.asidePanelWidth>0&&"top"in t&&this.$.panel["aside-body-scroll"].css({top:t.top}),this.xvar.frozenColumnIndex>0&&"top"in t&&this.$.panel["left-body-scroll"].css({top:t.top}),this.xvar.frozenRowIndex>0&&"left"in t&&this.$.panel["top-body-scroll"].css({left:t.left}),this.$.panel["body-scroll"].css(t),e.footSum&&"left"in t&&this.$.panel["bottom-body-scroll"].css({left:t.left}),!i&&"top"in t&&c.call(this)},u=function(){e.focusClear.call(this),e.clear.call(this),this.isInlineEditing&&f.deActive.call(this)},g=function(i){var n={UD:function(i){var n,o,a;for(var l in this.focusedColumn){n=jQuery.extend({},this.focusedColumn[l],!0);break}for(o=this.bodyRowMap[n.rowIndex+"_"+n.colIndex],e.focusClear.call(this),e.clear.call(this),i>0?n.rowIndex+(o.rowspan-1)+i>this.bodyRowTable.rows.length-1?(n.dindex=n.dindex+i,n.rowIndex=0,n.dindex>this.list.length-1&&(n.dindex=this.list.length-1)):n.rowIndex=n.rowIndex+i:n.rowIndex+i<0?(n.dindex=n.dindex+i,n.rowIndex=this.bodyRowTable.rows.length-1,n.dindex<0&&(n.dindex=0)):n.rowIndex=n.rowIndex+i,a=0;"undefined"==typeof this.bodyRowMap[n.rowIndex+"_"+n.colIndex]&&(0==n.rowIndex||a%2==(i>0?0:1)?n.colIndex--:n.rowIndex--,!(n.rowIndex<=0&&n.colIndex<=0));)a++;n.panelName=function(){var t=[];return this.xvar.frozenRowIndex>n.dindex&&t.push("top"),this.xvar.frozenColumnIndex>n.colIndex&&t.push("left"),t.push("body"),"top"!==t[0]&&t.push("scroll"),t.join("-")}.call(this),function(){n.dindex+1>this.xvar.frozenRowIndex&&(n.dindex<this.xvar.paintStartRowIndex?(h.call(this,{top:-(n.dindex-this.xvar.frozenRowIndex)*this.xvar.bodyTrHeight}),t.scroller.resize.call(this)):n.dindex+1>this.xvar.paintStartRowIndex+(this.xvar.paintRowCount-2)&&(h.call(this,{top:-(n.dindex-this.xvar.frozenRowIndex-this.xvar.paintRowCount+3)*this.xvar.bodyTrHeight}),t.scroller.resize.call(this)))}.call(this),this.focusedColumn[n.dindex+"_"+n.colIndex+"_"+n.rowIndex]=n,this.$.panel[n.panelName].find('[data-ax5grid-tr-data-index="'+n.dindex+'"]').find('[data-ax5grid-column-rowindex="'+n.rowIndex+'"][data-ax5grid-column-colindex="'+n.colIndex+'"]').attr("data-ax5grid-column-focused","true")},LR:function(i){var n,o,a=0,l=!1,r="";for(var s in this.focusedColumn){n=jQuery.extend({},this.focusedColumn[s],!0);break}for(o=this.bodyRowMap[n.rowIndex+"_"+n.colIndex],e.focusClear.call(this),e.clear.call(this),0>i?(n.colIndex=n.colIndex+i,n.colIndex<0&&(n.colIndex=0)):(n.colIndex=n.colIndex+(o.colspan-1)+i,n.colIndex>this.colGroup.length-1&&(n.colIndex=this.colGroup.length-1)),"undefined"==typeof this.bodyRowMap[n.rowIndex+"_"+n.colIndex]&&(n.rowIndex=0),a=0;"undefined"==typeof this.bodyRowMap[n.rowIndex+"_"+n.colIndex]&&(n.colIndex--,!(n.rowIndex<=0&&n.colIndex<=0));)a++;n.panelName=function(){var t=[],i="";return this.xvar.frozenRowIndex>n.dindex&&t.push("top"),this.xvar.frozenColumnIndex>n.colIndex&&t.push("left"),t.push("body"),"top"!==t[0]&&(this.xvar.frozenColumnIndex<=n.colIndex&&(r=t.join("-"),l=!0),t.push("scroll")),i=t.join("-")}.call(this),function(){}.call(this),this.focusedColumn[n.dindex+"_"+n.colIndex+"_"+n.rowIndex]=n;var d=this.$.panel[n.panelName].find('[data-ax5grid-tr-data-index="'+n.dindex+'"]').find('[data-ax5grid-column-rowindex="'+n.rowIndex+'"][data-ax5grid-column-colindex="'+n.colIndex+'"]').attr("data-ax5grid-column-focused","true");if(l){var c=function(){return d.position().left+d.outerWidth()>Math.abs(this.$.panel[n.panelName].position().left)+this.$.panel[r].width()?d.position().left+d.outerWidth()-this.$.panel[r].width():Math.abs(this.$.panel[n.panelName].position().left)>d.position().left?d.position().left:void 0}.call(this);"undefined"!=typeof c&&(t.header.scrollTo.call(this,{left:-c}),h.call(this,{left:-c}),t.scroller.resize.call(this))}},INDEX:function(i){var n,o,a;for(var l in this.focusedColumn){n=jQuery.extend({},this.focusedColumn[l],!0);break}for(n||(n={rowIndex:0,colIndex:0}),o=this.bodyRowMap[n.rowIndex+"_"+n.colIndex],e.focusClear.call(this),e.clear.call(this),"end"==i&&(i=this.list.length-1),n.dindex=i,n.rowIndex=0,a=0;"undefined"==typeof this.bodyRowMap[n.rowIndex+"_"+n.colIndex]&&(0==n.rowIndex||a%2==(_dy>0?0:1)?n.colIndex--:n.rowIndex--,!(n.rowIndex<=0&&n.colIndex<=0));)a++;n.panelName=function(){var t=[],i="";return this.xvar.frozenRowIndex>n.dindex&&t.push("top"),this.xvar.frozenColumnIndex>n.colIndex&&t.push("left"),t.push("body"),"top"!==t[0]&&t.push("scroll"),i=t.join("-")}.call(this),function(){n.dindex+1>this.xvar.frozenRowIndex&&(n.dindex<this.xvar.paintStartRowIndex?(h.call(this,{top:-(n.dindex-this.xvar.frozenRowIndex)*this.xvar.bodyTrHeight}),t.scroller.resize.call(this)):n.dindex+1>this.xvar.paintStartRowIndex+(this.xvar.paintRowCount-2)&&(h.call(this,{top:-(n.dindex-this.xvar.frozenRowIndex-this.xvar.paintRowCount+3)*this.xvar.bodyTrHeight}),t.scroller.resize.call(this)))}.call(this),this.focusedColumn[n.dindex+"_"+n.colIndex+"_"+n.rowIndex]=n,this.$.panel[n.panelName].find('[data-ax5grid-tr-data-index="'+n.dindex+'"]').find('[data-ax5grid-column-rowindex="'+n.rowIndex+'"][data-ax5grid-column-colindex="'+n.colIndex+'"]').attr("data-ax5grid-column-focused","true")}},o={UP:function(){n.UD.call(this,-1)},DOWN:function(){n.UD.call(this,1)},LEFT:function(){n.LR.call(this,-1)},RIGHT:function(){n.LR.call(this,1)},HOME:function(){n.INDEX.call(this,0)},END:function(){n.INDEX.call(this,"end")},position:function(t){n.INDEX.call(this,t)}};return i in o?(o[i].call(this),this):void o.position.call(this,i)},f={active:function(e,n,o){var a,l,r,s,d,c;this.inlineEditing={};for(var h in e){if(l=e[h].colIndex,!(c=this.colGroup[l].editor))return this;if(!function(i,e){return i.type in t.inlineEditor?"popup"==t.inlineEditor[i.type].editMode:void 0}(c))return this;if(a=e[h].dindex,r=e[h].rowIndex,s=e[h].panelName,d=e[h].colspan,this.list[a].__isGrouping)return!1;this.inlineEditing={columnKey:h,column:e[h]},this.isInlineEditing=!0}if(this.isInlineEditing){var u=function(t,e){return"money"==e.type?i.number(t,{money:!0}):t||""}.call(this,o,c);return this.inlineEditing.$inlineEditorCell=this.$.panel[s].find('[data-ax5grid-tr-data-index="'+a+'"]').find('[data-ax5grid-column-rowindex="'+r+'"][data-ax5grid-column-colindex="'+l+'"]').find("[data-ax5grid-cellholder]"),this.inlineEditing.$inlineEditor=t.inlineEditor[c.type].init(this,c,this.inlineEditing.$inlineEditorCell),this.inlineEditing.$inlineEditor.val(u).focus().select(),!0}},deActive:function(e){if(!this.inlineEditing)return this;var n=this.inlineEditing.column.dindex,o=(this.inlineEditing.column.rowIndex,this.inlineEditing.column.colIndex,this.bodyRowMap[this.inlineEditing.column.rowIndex+"_"+this.inlineEditing.column.colIndex]),a=function(t,e){return"money"==e.type?i.number(t):t}.call(this,this.inlineEditing.$inlineEditor.val(),o.editor),l={CANCEL:function(t,i,e){l.__clear.call(this)},RETURN:function(i,e,n){t.data.setValue.call(this,i,e.key,n)&&(l.__clear.call(this),t.body.repaint.call(this,!0))},__clear:function(){this.isInlineEditing=!1;var t=this.inlineEditing.$inlineEditor.data("binded-ax5ui");"ax5picker"==t&&this.inlineEditing.$inlineEditor.ax5picker("close"),this.inlineEditing.$inlineEditor.remove(),this.inlineEditing.$inlineEditor=null,this.inlineEditing.$inlineEditorCell=null,this.inlineEditing=!1}};e in l?l[e||"RETURN"].call(this,n,o,a):l.__clear.call(this)},keydown:function(i){var e={ESC:function(){f.deActive.call(this,"CANCEL")},RETURN:function(){if(this.isInlineEditing)f.deActive.call(this,"RETURN");else for(var i in this.focusedColumn){var e=this.focusedColumn[i],n=this.bodyRowMap[e.rowIndex+"_"+e.colIndex],o=e.dindex,a="";n&&(this.list[o].__isGrouping||(a=this.list[o][n.key])),t.body.inlineEdit.active.call(this,this.focusedColumn,null,a)}}};i in e&&e[i].call(this,i)}};t.body={init:a,repaint:c,updateRowState:o,scrollTo:h,blur:u,moveFocus:g,inlineEdit:f}}(),function(){var t=ax5.ui.grid,i=ax5.util,e=function(){for(var t=0,e=this.list.length;e--;)"__groupingList"in this.list[e]||(t+=i.number(this.list[e][this.key]));return t},n=function(){for(var t=0,e=this.list.length,n=0;e--;)"__groupingList"in this.list[e]||(t+=i.number(this.list[e][this.key]),n++);return i.number(t/(n||1),{round:2})};t.collector={sum:e,avg:n}}(),function(){var t=ax5.ui.grid,i=ax5.util,e=function(){},n=function(t){for(var i=0,e=t.length,n=[];e>i;i++)t[i]&&!t[i].__isGrouping&&(t[i][this.config.columnKeys.selected]&&this.selectedDataIndexs.push(i),n.push(jQuery.extend({},t[i])));return n},o=function(t){this.selectedDataIndexs=[];var e=0,n=t.length,o=[];if(this.config.body.grouping)for(var a,l,r=i.map(this.bodyGrouping.by,function(){return{key:this,compareString:"",grouping:!1,list:[]}}),s=0,d=r.length,c=[];n+1>e;e++){for(s=0,a="",c=[];d>s;s++){if(t[e]&&(a+="$|$"+t[e][r[s].key]),e>0&&a!=r[s].compareString){for(var h={keys:[],labels:[],list:r[s].list},u=0;s+1>u;u++)h.keys.push(r[u].key),h.labels.push(t[e-1][r[u].key]);c.push(h),r[s].list=[]}r[s].list.push(t[e]),r[s].compareString=a}for(l=c.length;l--;)o.push({__isGrouping:!0,__groupingList:c[l].list,__groupingBy:{keys:c[l].keys,labels:c[l].labels}});t[e]&&(t[e][this.config.columnKeys.selected]&&this.selectedDataIndexs.push(e),o.push(t[e]))}else for(;n>e;e++)t[e]&&(t[e][this.config.columnKeys.selected]&&this.selectedDataIndexs.push(e),o.push(t[e]));return o},a=function(e){return i.isArray(e)?(this.page=null,this.list=o.call(this,Object.keys(this.sortInfo).length?g.call(this,this.sortInfo,e):e)):"page"in e&&(this.page=jQuery.extend({},e.page),this.list=o.call(this,Object.keys(this.sortInfo).length?g.call(this,this.sortInfo,e.list):e.list)),this.needToPaintSum=!0,this.xvar.frozenRowIndex=this.config.frozenRowIndex>this.list.length?this.list.length:this.config.frozenRowIndex,this.xvar.paintStartRowIndex=void 0,t.page.navigationUpdate.call(this),this.config.body.grouping,this},l=function(){},r=function(e,a){var l=this.config.body.grouping?n.call(this,this.list):this.list,r={first:function(){l=[].concat(e).concat(l)},last:function(){l=l.concat([].concat(e))}};if("undefined"==typeof a&&(a="last"),a in r)r[a].call(this,e);else{if(!i.isNumber(a))throw"invalid argument _dindex";l=l.splice(a,[].concat(e))}return this.config.body.grouping?l=o.call(this,g.call(this,this.sortInfo,l)):Object.keys(this.sortInfo).length&&(l=g.call(this,this.sortInfo,l)),this.list=l,this.needToPaintSum=!0,this.xvar.frozenRowIndex=this.config.frozenRowIndex>this.list.length?this.list.length:this.config.frozenRowIndex,this.xvar.paintStartRowIndex=void 0,t.page.navigationUpdate.call(this),this},s=function(e){var a=this.config.body.grouping?n.call(this,this.list):this.list,l={first:function(){a.splice(e,1)},last:function(){var t=a.length-1;a.splice(t,1)}};if("undefined"==typeof e&&(e="last"),e in l)l[e].call(this,e);else{if(!i.isNumber(e))throw"invalid argument _dindex";a.splice(e,1)}return this.config.body.grouping?a=o.call(this,g.call(this,this.sortInfo,a)):Object.keys(this.sortInfo).length&&(a=g.call(this,this.sortInfo,a)),this.list=a,this.needToPaintSum=!0,this.xvar.frozenRowIndex=this.config.frozenRowIndex>this.list.length?this.list.length:this.config.frozenRowIndex,this.xvar.paintStartRowIndex=void 0,t.page.navigationUpdate.call(this),this},d=function(t,e){if(!i.isNumber(e))throw"invalid argument _dindex";this.needToPaintSum=!0,this.list.splice(e,1,t),this.config.body.grouping&&(this.list=o.call(this,n.call(this,this.list)))},c=function(t,i,e){return this.needToPaintSum=!0,this.list[t][i]=e},h=function(){this.selectedDataIndexs=[]},u=function(t,i){var e=this.config;return this.list[t].__isGrouping?!1:("undefined"==typeof i?(this.list[t][e.columnKeys.selected]=!this.list[t][e.columnKeys.selected])&&this.selectedDataIndexs.push(t):(this.list[t][e.columnKeys.selected]=i)&&this.selectedDataIndexs.push(t),this.list[t][e.columnKeys.selected])},g=function(e,n){var o=n||this.list,a=[];for(var l in e)a[e[l].seq]={key:l,order:e[l].orderBy};a=i.filter(a,function(){return"undefined"!=typeof this});var r,s,d=0,c=a.length;return o.sort(function(t,i){for(d=0;c>d;d++){if(r=t[a[d].key],s=i[a[d].key],("undefined"==typeof r?"undefined":_typeof(r))!==("undefined"==typeof s?"undefined":_typeof(s))&&(r=""+r,s=""+s),s>r)return"asc"===a[d].order?-1:1;if(r>s)return"asc"===a[d].order?1:-1}}),n?o:(this.xvar.frozenRowIndex=this.config.frozenRowIndex>this.list.length?this.list.length:this.config.frozenRowIndex,this.xvar.paintStartRowIndex=void 0,t.page.navigationUpdate.call(this),this)};t.data={init:e,set:a,get:l,setValue:c,clearSelect:h,select:u,add:r,remove:s,update:d,sort:g,initData:o,clearGroupingData:n}}(),function(){var t=ax5.ui.grid,i=ax5.util,e=function(){return i.number(this.value,{money:!0})};t.formatter={money:e}}(),function(){var t=ax5.ui.grid,i=ax5.util,e={on:function(n,o){var a=this,l=$(n),r=l.offset().left,s=a.$.container.root.offset().left;a.xvar.columnResizerIndex=o;var d={min:-a.colGroup[o]._width+2,max:a.colGroup[o+1]?a.colGroup[o+1]._width:a.$.container.root.width()-2};jQuery(document.body).bind(t.util.ENM.mousemove+".ax5grid-"+this.instanceId,function(i){var e=t.util.getMousePosition(i);a.xvar.__da=e.clientX-a.xvar.mousePosition.clientX,d.min>a.xvar.__da?a.xvar.__da=d.min:d.max<a.xvar.__da&&(a.xvar.__da=d.max),a.xvar.columnResizerLived||a.$.resizer.horizontal.addClass("live"),a.xvar.columnResizerLived=!0,a.$.resizer.horizontal.css({left:r+a.xvar.__da-s})}).bind(t.util.ENM.mouseup+".ax5grid-"+this.instanceId,function(t){e.off.call(a),i.stopEvent(t)}).bind("mouseleave.ax5grid-"+this.instanceId,function(t){e.off.call(a),i.stopEvent(t)}),jQuery(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(){this.$.resizer.horizontal.removeClass("live"),this.xvar.columnResizerLived=!1,this.setColumnWidth(this.colGroup[this.xvar.columnResizerIndex]._width+this.xvar.__da,this.xvar.columnResizerIndex),jQuery(document.body).unbind(t.util.ENM.mousemove+".ax5grid-"+this.instanceId).unbind(t.util.ENM.mouseup+".ax5grid-"+this.instanceId).unbind("mouseleave.ax5grid-"+this.instanceId),jQuery(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},n=function(){var n=this;this.$.container.header.on("click","[data-ax5grid-column-attr]",function(t){var i=this.getAttribute("data-ax5grid-column-key"),e=this.getAttribute("data-ax5grid-column-colindex"),o=(this.getAttribute("data-ax5grid-column-rowindex"),n.colGroup[e]);i&&o&&o.sortable!==!1&&n.config.sortable!==!1&&(o.sortFixed||r.call(n,o.key))}),this.$.container.header.on("mousedown","[data-ax5grid-column-resizer]",function(o){var a=this.getAttribute("data-ax5grid-column-resizer");n.xvar.mousePosition=t.util.getMousePosition(o),e.on.call(n,this,Number(a)),i.stopEvent(o)}).on("dragstart",function(t){return i.stopEvent(t),!1}),o.call(this)},o=function(){var i=this.config,e=t.util.divideTableByFrozenColumnIndex(this.headerTable,this.config.frozenColumnIndex);this.asideHeaderData=function(t){for(var e=[],n={rows:[]},o=0,a=t.rows.length;a>o;o++)if(n.rows[o]={cols:[]},0===o){var l={label:"",colspan:1,rowspan:t.rows.length,key:"__dindex__",colIndex:null},r={};i.showLineNumber&&(r=jQuery.extend({},l,{label:"&nbsp;",width:i.lineNumberColumnWidth,_width:i.lineNumberColumnWidth}),e.push(r),n.rows[o].cols.push(r)),i.showRowSelector&&(r=jQuery.extend({},l,{label:"",width:i.rowSelectorColumnWidth,_width:i.rowSelectorColumnWidth}),e.push(r),n.rows[o].cols.push(r))}return this.asideColGroup=e,n}.call(this,this.headerTable),this.leftHeaderData=e.leftData,this.headerData=e.rightData},a=function(t){var e=this.config,n=this.colGroup;t&&(o.call(this),this.xvar.paintStartRowIndex=void 0);var a=this.asideHeaderData,l=this.leftHeaderData,r=this.headerData,s=e.header.align;this.leftHeaderColGroup=n.slice(0,this.config.frozenColumnIndex),this.headerColGroup=n.slice(this.config.frozenColumnIndex);var d=function(t,o,a){var l=0,r=[];r.push('<table border="0" cellpadding="0" cellspacing="0">'),r.push("<colgroup>");for(var d=0,c=o.length;c>d;d++)r.push('<col style="width:'+o[d]._width+'px;"  />'),l+=o[d]._width;r.push("<col  />"),r.push("</colgroup>");for(var h=0,u=a.rows.length;u>h;h++){var g="";r.push('<tr class="'+g+'">');for(var f=0,x=a.rows[h].cols.length;x>f;f++){var p=a.rows[h].cols[f],m=e.header.columnHeight*p.rowspan-e.header.columnBorderWidth,v=s||p.align;r.push("<td ",'data-ax5grid-column-attr="'+(p.columnAttr||"default")+'" ','data-ax5grid-column-row="'+h+'" ','data-ax5grid-column-col="'+f+'" ',function(){return"undefined"!=typeof p.key?'data-ax5grid-column-key="'+p.key+'" ':""}(),'data-ax5grid-column-colindex="'+p.colIndex+'" ','data-ax5grid-column-rowindex="'+p.rowIndex+'" ','colspan="'+p.colspan+'" ','rowspan="'+p.rowspan+'" ','class="'+function(t){var n="";return t.styleClass&&(n+=i.isFunction(t.styleClass)?t.styleClass.call({column:t,key:t.key})+" ":t.styleClass+" "),e.header.columnBorderWidth&&(n+="hasBorder "),f==x-1&&(n+="isLastColumn "),n}.call(this,p)+'" ','style="height: '+m+'px;min-height: 1px;">'),r.push(function(){var t=e.header.columnHeight-2*e.header.columnPadding-e.header.columnBorderWidth;return'<span data-ax5grid-cellHolder="" '+(v?'data-ax5grid-text-align="'+v+'"':"")+' style="height: '+(e.header.columnHeight-e.header.columnBorderWidth)+"px;line-height: "+t+'px;">'}(),function(){var t="";return i.isNothing(p.key)||i.isNothing(p.colIndex)||e.sortable===!1||p.sortable===!1||(t+='<span data-ax5grid-column-sort="'+p.colIndex+'" data-ax5grid-column-sort-order="'+(n[p.colIndex].sort||"")+'" />'),t}(),p.label||"&nbsp;","</span>"),i.isNothing(p.colIndex)||e.enableFilter&&r.push('<span data-ax5grid-column-filter="'+p.colIndex+'" data-ax5grid-column-filter-value=""  />'),r.push("</td>")}r.push("<td ",'data-ax5grid-column-row="null" ','data-ax5grid-column-col="null" ','style="height: '+e.header.columnHeight+'px;min-height: 1px;" ',"></td>"),r.push("</tr>")}return r.push("</table>"),t.html(r.join("")),function(){for(var n=e.header.columnHeight*a.rows.length-e.header.columnBorderWidth,l=0,r=[],s=0,d=o.length;d>s;s++){var c=o[s];i.isNothing(c.colIndex)||(l+=c._width,r.push('<div data-ax5grid-column-resizer="'+c.colIndex+'" style="height:'+n+"px;left: "+(l-4)+'px;"  />'))}t.append(r)}.call(this),l};e.asidePanelWidth>0&&d(this.$.panel["aside-header"],this.asideColGroup,a),e.frozenColumnIndex>0&&d(this.$.panel["left-header"],this.leftHeaderColGroup,l),this.xvar.scrollContentWidth=d(this.$.panel["header-scroll"],this.headerColGroup,r),e.rightSum},l=function(t){return this.$.panel["header-scroll"].css(t),this},r=function(t){var i="",e={},n=0;for(var o in this.sortInfo)this.sortInfo[o].fixed&&(e[o]=this.sortInfo[o],n++);for(var a=0,l=this.colGroup.length;l>a;a++)this.colGroup[a].key==t?(""==i&&(i="undefined"==typeof this.colGroup[a].sort?"desc":"desc"===this.colGroup[a].sort?"asc":void 0),this.colGroup[a].sort=i):this.config.multiSort||(this.colGroup[a].sort=void 0),"undefined"!=typeof this.colGroup[a].sort&&(e[this.colGroup[a].key]||(e[this.colGroup[a].key]={seq:n++,orderBy:this.colGroup[a].sort}));return this.setColumnSort(e),this},s=function(t){for(var i=0,e=this.colGroup.length;e>i;i++)for(var n in t)this.colGroup[i].key==n&&(this.colGroup[i].sort=t[n].orderBy);return this};t.header={init:n,repaint:a,scrollTo:l,toggleSort:r,applySortStatus:s}}(),function(){var t=ax5.ui.grid,i={editMode:"popup",getHtml:function(t,i){return'<input type="text" data-ax5grid-editor="text" value="" >'},init:function(t,i,e){var n;return e.append(n=jQuery(this.getHtml(t,i))),this.bindUI(t,n,i,e),n},bindUI:function(t,i,e,n){}},e={editMode:"popup",getHtml:function(t,i){return'<input type="text" data-ax5grid-editor="money" value="" >'},init:function(t,i,e){var n;return e.append(n=jQuery(this.getHtml(t,i))),this.bindUI(t,n,i,e),n},bindUI:function(t,i,e,n){i.data("binded-ax5ui","ax5formater"),i.ax5formatter({pattern:"money"})}},n={editMode:"popup",getHtml:function(t,i){return'<input type="text" data-ax5grid-editor="number" value="" >'},init:function(t,i,e){var n;return e.append(n=jQuery(this.getHtml(t,i))),this.bindUI(t,n,i,e),n},bindUI:function(t,i,e,n){i.data("binded-ax5ui","ax5formater"),i.ax5formatter({pattern:"number"})}},o={editMode:"popup",getHtml:function(t,i){return'<input type="text" data-ax5grid-editor="calendar" value="" >'},init:function(t,i,e){var n;return e.append(n=jQuery(this.getHtml(t,i))),this.bindUI(t,n,i,e),n},bindUI:function(i,e,n,o){var a=i;e.data("binded-ax5ui","ax5picker"),e.ax5picker({direction:"auto",content:{type:"date",formatter:{pattern:"date"}},onStateChanged:function(){"close"==this.state&&t.body.inlineEdit.deActive.call(a,"RETURN")}})}},a={editMode:"popup",getHtml:function(t,i){var e={columnKeys:{optionValue:"value",optionText:"text"}};jQuery.extend(!0,e,i.config);var n=[];n.push('<select data-ax5grid-editor="select">');for(var o=0,a=e.options.length;a>o;o++)n.push('<option value="'+e.options[o][e.columnKeys.optionValue]+'">',e.options[o][e.columnKeys.optionText],"</option>");return n.push("</select>"),n.join("")},init:function(t,i,e){var n;return e.append(n=jQuery(this.getHtml(t,i))),this.bindUI(t,n,i,e),n},bindUI:function(t,i,e,n){}},l={editMode:"inline",getHtml:function(t,i,e){var n=t.config.body.columnHeight-2*t.config.body.columnPadding-t.config.body.columnBorderWidth,o=0==e||"false"==e||"1">e?"false":"true",a={marginTop:2,height:n-4};return jQuery.extend(!0,a,i.config),a.marginTop=(n-a.height)/2,'<div data-ax5grid-editor="checkbox" data-ax5grid-checked="'+o+'" style="height:'+a.height+"px;width:"+a.height+"px;margin-top:"+a.marginTop+'px;"></div>'}};t.inlineEditor={text:i,money:e,number:n,date:o,select:a,checkbox:l}}(),function(){var t=ax5.ui.grid,i=ax5.util,e=function(t){var i=function(t){this.page.currentPage!=t&&(this.page.selectPage=t,this.config.page.onChange&&this.config.page.onChange.call({self:this,page:this.page,data:this.data}))},e={first:function(){i.call(this,0)},prev:function(){var t=this.page.currentPage-1;0>t&&(t=0),i.call(this,t)},next:function(){var t=this.page.currentPage+1;t>this.page.totalPages-1&&(t=this.page.totalPages-1),i.call(this,t)},last:function(){i.call(this,this.page.totalPages-1)}};t in e?e[t].call(this):i.call(this,t-1)},n=function(){var i=this;if(this.page){var n={currentPage:this.page.currentPage,pageSize:this.page.pageSize,totalElements:this.page.totalElements,totalPages:this.page.totalPages,firstIcon:this.config.page.firstIcon,prevIcon:this.config.page.prevIcon||"«",nextIcon:this.config.page.nextIcon||"»",lastIcon:this.config.page.lastIcon},o=this.config.page.navigationItemCount;n["@paging"]=function(){var t=[],i=n.currentPage-Math.floor(o/2);0>i&&(i=0);var e=n.currentPage+o;e>n.totalPages&&(e=n.totalPages),e-i>o&&(e=i+o),o>e-i&&(i=e-o),0>i&&(i=0);for(var a=i,l=e;l>a;a++)t.push({pageNo:a+1,selected:n.currentPage==a});return t}(),this.$.page.navigation.html(t.tmpl.get("page_navigation",n)),this.$.page.navigation.find("[data-ax5grid-page-move]").on("click",function(){var t=this.getAttribute("data-ax5grid-page-move");e.call(i,t)})}else this.$.page.navigation.empty()},o=function(){var e=this.xvar.paintStartRowIndex,n=this.xvar.paintStartRowIndex+this.xvar.paintRowCount-1,o=this.xvar.dataRowCount;n>o&&(n=o),this.$.page.status.html(t.tmpl.get("page_status",{fromRowIndex:i.number(e+1,{money:!0}),toRowIndex:i.number(n,{money:!0}),totalElements:i.number(o,{money:!0})}))};t.page={navigationUpdate:n,statusUpdate:o}}(),function(){var t=ax5.ui.grid,i=ax5.util,e={vertical:function(t,i){var e=i._content_height-i._panel_height,n=i._vertical_scroller_height-i.verticalScrollBarHeight,o=e*t.top/n;return 0>o?o=0:o>e&&(o=e),{top:-o}},horizontal:function(t,i){var e=i._content_width-i._panel_width,n=i._horizontal_scroller_width-i.horizontalScrollBarWidth,o=e*t.left/n;return 0>o?o=0:o>e&&(o=e),{left:-o}}},n={vertical:function(i,n){var o="vertical",a=n._content_height-n._panel_height,l=n._vertical_scroller_height-n.verticalScrollBarHeight,r=l*i/a;if(-r>l){r=-l;var s=e[o].call(this,{top:-r},{_content_width:n._content_width,_content_height:n._content_height,_panel_width:n._panel_width,_panel_height:n._panel_height,_horizontal_scroller_width:n._horizontal_scroller_width,_vertical_scroller_height:n._vertical_scroller_height,verticalScrollBarHeight:n.verticalScrollBarHeight,horizontalScrollBarWidth:n.horizontalScrollBarWidth});t.body.scrollTo.call(this,s)}return-r},horizontal:function(i,n){var o="horizontal",a=n._content_width-n._panel_width,l=n._horizontal_scroller_width-n.horizontalScrollBarWidth,r=l*i/a;if(-r>l){r=-l;var s=e[o].call(this,{left:-r},{_content_width:n._content_width,_content_height:n._content_height,_panel_width:n._panel_width,_panel_height:n._panel_height,_horizontal_scroller_width:n._horizontal_scroller_width,_vertical_scroller_height:n._vertical_scroller_height,verticalScrollBarHeight:n.verticalScrollBarHeight,horizontalScrollBarWidth:n.horizontalScrollBarWidth});t.header.scrollTo.call(this,s),t.body.scrollTo.call(this,s)}return-r}},o={click:function(i,n,o,a){var l=this,r=i.offset(),s={width:n.width(),height:n.height()},d={width:i.innerWidth(),height:i.innerHeight()},c=l.$.scroller.vertical.innerHeight(),h=l.$.panel.body.height(),u=l.$.scroller.horizontal.innerWidth(),g=l.$.panel.body.width(),f=l.xvar.scrollContentHeight,x=l.xvar.scrollContentWidth,p=l.$.scroller["vertical-bar"].height(),m=l.$.scroller["horizontal-bar"].width(),v={vertical:function(i){var e=t.util.getMousePosition(i),n=e.clientY-r.top;return 0>n?n=0:n+s.height>d.height&&(n=d.height-s.height),{top:n}},horizontal:function(i){var e=t.util.getMousePosition(i),n=e.clientX-r.left;return 0>n?n=0:n+s.width>d.width&&(n=d.width-s.width),{left:n}}},b=v[o](a);n.css(b);var y=e[o].call(l,b,{_content_width:x,_content_height:f,_panel_width:g,_panel_height:h,_horizontal_scroller_width:u,_vertical_scroller_height:c,verticalScrollBarHeight:p,horizontalScrollBarWidth:m});"horizontal"===o&&t.header.scrollTo.call(l,y),t.body.scrollTo.call(l,y)},on:function(i,n,a){var l=this,r=n.position(),s={width:n.width(),height:n.height()},d={width:i.innerWidth(),height:i.innerHeight()},c=l.$.scroller.vertical.innerHeight(),h=l.$.panel.body.height(),u=l.$.scroller.horizontal.innerWidth(),g=l.$.panel.body.width(),f=l.xvar.scrollContentHeight,x=l.xvar.scrollContentWidth,p=l.$.scroller["vertical-bar"].height(),m=l.$.scroller["horizontal-bar"].width(),v={vertical:function(i){var e=t.util.getMousePosition(i);l.xvar.__da=e.clientY-l.xvar.mousePosition.clientY;var n=r.top+l.xvar.__da;return 0>n?n=0:n+s.height>d.height&&(n=d.height-s.height),{top:n}},horizontal:function(i){var e=t.util.getMousePosition(i);l.xvar.__da=e.clientX-l.xvar.mousePosition.clientX;var n=r.left+l.xvar.__da;return 0>n?n=0:n+s.width>d.width&&(n=d.width-s.width),{left:n}}};l.xvar.__da=0,jQuery(document.body).bind(t.util.ENM.mousemove+".ax5grid-"+this.instanceId,function(i){var o=v[a](i);n.css(o);var r=e[a].call(l,o,{_content_width:x,_content_height:f,_panel_width:g,_panel_height:h,_horizontal_scroller_width:u,_vertical_scroller_height:c,verticalScrollBarHeight:p,horizontalScrollBarWidth:m});"horizontal"===a&&t.header.scrollTo.call(l,r),t.body.scrollTo.call(l,r)}).bind(t.util.ENM.mouseup+".ax5grid-"+this.instanceId,function(t){o.off.call(l)}).bind("mouseleave.ax5grid-"+this.instanceId,function(t){o.off.call(l)}),jQuery(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(){jQuery(document.body).unbind(t.util.ENM.mousemove+".ax5grid-"+this.instanceId).unbind(t.util.ENM.mouseup+".ax5grid-"+this.instanceId).unbind("mouseleave.ax5grid-"+this.instanceId),jQuery(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},a={wheel:function(i){var e,n,o=this,a=o.$.panel["body-scroll"].position(),l=o.$.panel.body.height(),s=o.$.panel.body.width(),d=o.xvar.scrollContentHeight,c=o.xvar.scrollContentWidth,h=!1,u=!1;return e=a.left-i.x,n=a.top-i.y,n>=0?(n=0,h=!0):l-d>=n?(n=l-d,n>=0&&(n=0),h=!0):0==i.y&&(h=!0),e>=0?(e=0,u=!0):s-c>=e?(e=s-c,e>=0&&(e=0),u=!0):0==i.x&&(u=!0),t.header.scrollTo.call(this,{left:e}),t.body.scrollTo.call(this,{left:e,top:n}),r.call(this),!h||!u},on:function(){var e=this,n=e.$.panel["body-scroll"].position(),o=e.$.panel.body.height(),l=e.$.panel.body.width(),s=e.xvar.scrollContentHeight,d=e.xvar.scrollContentWidth,c=function(i){var a,r,c=t.util.getMousePosition(i);return e.xvar.__x_da=c.clientX-e.xvar.mousePosition.clientX,e.xvar.__y_da=c.clientY-e.xvar.mousePosition.clientY,a=n.left+e.xvar.__x_da,r=n.top+e.xvar.__y_da,r>=0?r=0:o-s>=r&&(r=o-s,r>=0&&(r=0)),a>=0?a=0:l-d>=a&&(a=l-d,a>=0&&(a=0)),{left:a,top:r}};this.xvar.__x_da=0,this.xvar.__y_da=0,jQuery(document.body).bind("touchmove.ax5grid-"+this.instanceId,function(n){var o=c(n);t.header.scrollTo.call(e,{left:o.left}),t.body.scrollTo.call(e,o,"noRepaint"),r.call(e),i.stopEvent(n)}).bind("touchend.ax5grid-"+this.instanceId,function(n){var o=c(n);t.header.scrollTo.call(e,{left:o.left}),t.body.scrollTo.call(e,o),r.call(e),i.stopEvent(n),a.off.call(e)}),jQuery(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(){jQuery(document.body).unbind("touchmove.ax5grid-"+this.instanceId).unbind("touchend.ax5grid-"+this.instanceId),jQuery(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},l=function(){var e=this,n=4;this.$.scroller["vertical-bar"].css({width:this.config.scroller.size-(n+1),left:n/2}),this.$.scroller["horizontal-bar"].css({height:this.config.scroller.size-(n+1),top:n/2}),this.$.scroller["vertical-bar"].bind(t.util.ENM.mousedown,function(i){this.xvar.mousePosition=t.util.getMousePosition(i),o.on.call(this,this.$.scroller.vertical,this.$.scroller["vertical-bar"],"vertical")}.bind(this)).bind("dragstart",function(t){return i.stopEvent(t),!1}),this.$.scroller.vertical.bind("click",function(t){t.target&&"vertical"==t.target.getAttribute("data-ax5grid-scroller")&&o.click.call(this,this.$.scroller.vertical,this.$.scroller["vertical-bar"],"vertical",t)}.bind(this)),this.$.scroller["horizontal-bar"].bind(t.util.ENM.mousedown,function(i){this.xvar.mousePosition=t.util.getMousePosition(i),o.on.call(this,this.$.scroller.horizontal,this.$.scroller["horizontal-bar"],"horizontal")}.bind(this)).bind("dragstart",function(t){return i.stopEvent(t),!1}),this.$.scroller.horizontal.bind("click",function(t){t.target&&"horizontal"==t.target.getAttribute("data-ax5grid-scroller")&&o.click.call(this,this.$.scroller.horizontal,this.$.scroller["horizontal-bar"],"horizontal",t)}.bind(this)),this.$.container.body.bind("mousewheel DOMMouseScroll",function(t){var e=t.originalEvent,n={x:0,y:0};e.detail?n.y=10*e.detail:"undefined"==typeof e.deltaY?(n.y=-e.wheelDelta,n.x=0):(n.y=e.deltaY,n.x=e.deltaX),a.wheel.call(this,n)&&i.stopEvent(t)}.bind(this)),document.addEventListener&&ax5.info.supportTouch&&this.$.container.body.on("touchstart","[data-ax5grid-panel]",function(i){
e.xvar.mousePosition=t.util.getMousePosition(i),a.on.call(e)})},r=function(){var t=this.$.scroller.vertical.height(),i=this.$.scroller.horizontal.width(),e=this.$.panel.body.height(),o=this.$.panel.body.width(),a=this.xvar.scrollContentHeight,l=this.xvar.scrollContentWidth,r=e*t/a,s=o*i/l;r<this.config.scroller.barMinSize&&(r=this.config.scroller.barMinSize),s<this.config.scroller.barMinSize&&(s=this.config.scroller.barMinSize),this.$.scroller["vertical-bar"].css({top:n.vertical.call(this,this.$.panel["body-scroll"].position().top,{_content_width:l,_content_height:a,_panel_width:o,_panel_height:e,_horizontal_scroller_width:i,_vertical_scroller_height:t,verticalScrollBarHeight:r,horizontalScrollBarWidth:s}),height:r}),this.$.scroller["horizontal-bar"].css({left:n.horizontal.call(this,this.$.panel["body-scroll"].position().left,{_content_width:l,_content_height:a,_panel_width:o,_panel_height:e,_horizontal_scroller_width:i,_vertical_scroller_height:t,verticalScrollBarHeight:r,horizontalScrollBarWidth:s}),width:s}),t=null,i=null,e=null,o=null,a=null,l=null,r=null,s=null};t.scroller={init:l,resize:r}}(),function(){var t=ax5.ui.grid,i='<div data-ax5grid-container="root" data-ax5grid-instance="{{instanceId}}">\n            <div data-ax5grid-container="hidden">\n                <textarea data-ax5grid-form="clipboard"></textarea>\n            </div>\n            <div data-ax5grid-container="header">\n                <div data-ax5grid-panel="aside-header"></div>\n                <div data-ax5grid-panel="left-header"></div>\n                <div data-ax5grid-panel="header">\n                    <div data-ax5grid-panel-scroll="header"></div>\n                </div>\n                <div data-ax5grid-panel="right-header"></div>\n            </div>\n            <div data-ax5grid-container="body">\n                <div data-ax5grid-panel="top-aside-body"></div>\n                <div data-ax5grid-panel="top-left-body"></div>\n                <div data-ax5grid-panel="top-body">\n                    <div data-ax5grid-panel-scroll="top-body"></div>\n                </div>\n                <div data-ax5grid-panel="top-right-body"></div>\n                <div data-ax5grid-panel="aside-body">\n                    <div data-ax5grid-panel-scroll="aside-body"></div>\n                </div>\n                <div data-ax5grid-panel="left-body">\n                    <div data-ax5grid-panel-scroll="left-body"></div>\n                </div>\n                <div data-ax5grid-panel="body">\n                    <div data-ax5grid-panel-scroll="body"></div>\n                </div>\n                <div data-ax5grid-panel="right-body">\n                  <div data-ax5grid-panel-scroll="right-body"></div>\n                </div>\n                <div data-ax5grid-panel="bottom-aside-body"></div>\n                <div data-ax5grid-panel="bottom-left-body"></div>\n                <div data-ax5grid-panel="bottom-body">\n                    <div data-ax5grid-panel-scroll="bottom-body"></div>\n                </div>\n                <div data-ax5grid-panel="bottom-right-body"></div>\n            </div>\n            <div data-ax5grid-container="page">\n                <div data-ax5grid-page="holder">\n                    <div data-ax5grid-page="navigation"></div>\n                    <div data-ax5grid-page="status"></div>\n                </div>\n            </div>\n            <div data-ax5grid-container="scroller">\n                <div data-ax5grid-scroller="vertical">\n                    <div data-ax5grid-scroller="vertical-bar"></div>    \n                </div>\n                <div data-ax5grid-scroller="horizontal">\n                    <div data-ax5grid-scroller="horizontal-bar"></div>\n                </div>\n                <div data-ax5grid-scroller="corner"></div>\n            </div>\n            <div data-ax5grid-resizer="vertical"></div>\n            <div data-ax5grid-resizer="horizontal"></div>\n        </div>',e='<div data-ax5grid-page-navigation="holder">\n            <div data-ax5grid-page-navigation="cell">    \n                {{#firstIcon}}<button data-ax5grid-page-move="first">{{{firstIcon}}}</button>{{/firstIcon}}\n                <button data-ax5grid-page-move="prev">{{{prevIcon}}}</button>\n            </div>\n            <div data-ax5grid-page-navigation="cell-paging">\n                {{#@paging}}\n                <button data-ax5grid-page-move="{{pageNo}}" data-ax5grid-page-selected="{{selected}}">{{pageNo}}</button>\n                {{/@paging}}\n            </div>\n            <div data-ax5grid-page-navigation="cell">\n                <button data-ax5grid-page-move="next">{{{nextIcon}}}</button>\n                {{#lastIcon}}<button data-ax5grid-page-move="last">{{{lastIcon}}}</button>{{/lastIcon}}\n            </div>\n        </div>',n="<span>{{fromRowIndex}} - {{toRowIndex}} of {{totalElements}}</span>";t.tmpl={main:i,page_navigation:e,page_status:n,get:function(i,e){return ax5.mustache.render(t.tmpl[i],e)}}}(),function(){var t=ax5.ui.grid,i=ax5.util,e=function(t,i){for(var e={rows:[]},n={rows:[]},o=0,a=t.rows.length;a>o;o++){var l=t.rows[o];e.rows[o]={cols:[]},n.rows[o]={cols:[]};for(var r=0,s=l.cols.length;s>r;r++){var d=jQuery.extend({},l.cols[r]),c=d.colIndex,h=d.colIndex+d.colspan;if(i>c)if(i>=h)e.rows[o].cols.push(d);else{var u=jQuery.extend({},d),g=jQuery.extend({},u);u.colspan=i-u.colIndex,g.colIndex=i,g.colspan=d.colspan-u.colspan,e.rows[o].cols.push(u),n.rows[o].cols.push(g)}else n.rows[o].cols.push(d)}}return{leftData:e,rightData:n}},n=function(t){var i,e=t.originalEvent?t.originalEvent:t;return i="changedTouches"in e?e.changedTouches[0]:e,{clientX:i.pageX,clientY:i.pageY}},o={mousedown:ax5.info.supportTouch?"touchstart":"mousedown",mousemove:ax5.info.supportTouch?"touchmove":"mousemove",mouseup:ax5.info.supportTouch?"touchend":"mouseup"},a=function(t){var e=i.deepCopy(t),n=this.config,o={rows:[]},a=0,l=function h(t,i,e){for(var l={cols:[]},r=0,s=t.length;s>r;r++){var d=t[r],c=1;d.hidden||(d.colspan=1,d.rowspan=1,d.rowIndex=i,d.colIndex=function(){return e?(a=e.colIndex+r+1,e.colIndex+r):a++}(),l.cols.push(d),"columns"in d?c=h(d.columns,i+1,d):d.width="width"in d?d.width:n.columnMinWidth,d.colspan=c)}return l.cols.length>0?(o.rows[i]||(o.rows[i]={cols:[]}),o.rows[i].cols=o.rows[i].cols.concat(l.cols),l.cols.length-1+c):c};l(e,0);for(var r=0,s=o.rows.length;s>r;r++)for(var d=0,c=o.rows[r].cols.length;c>d;d++)"columns"in o.rows[r].cols[d]||(o.rows[r].cols[d].rowspan=s-r);return o},l=function(t){var e=i.deepCopy(t),n={rows:[]},o=0,a=function l(t,i,e){for(var a={cols:[]},r=0,s=t.length,d=(function u(t){for(var n=0,r=t.length;r>n;n++){var s=t[n],d=1;s.hidden||("key"in s?(s.colspan=1,s.rowspan=1,s.rowIndex=i,s.colIndex=function(){return e?(o=e.colIndex+n+1,e.colIndex+n):o++}(),a.cols.push(s),"columns"in s&&(d=l(s.columns,i+1,s)),s.colspan=d):"columns"in s&&u(s.columns,i))}});s>r;r++){var c=t[r],h=1;c.hidden||("key"in c?(c.colspan=1,c.rowspan=1,c.rowIndex=i,c.colIndex=function(){return e?(o=e.colIndex+r+1,e.colIndex+r):o++}(),a.cols.push(c),"columns"in c&&(h=l(c.columns,i+1,c)),c.colspan=h):"columns"in c&&d(c.columns,i))}return a.cols.length>0?(n.rows[i]||(n.rows[i]={cols:[]}),n.rows[i].cols=n.rows[i].cols.concat(a.cols),a.cols.length-1+h):h};return a(e,0),function(t){for(var i=0,e=t.rows.length;e>i;i++)for(var n=t.rows[i],o=0,a=n.cols.length;a>o;o++){var l=n.cols[o];"columns"in l||(l.rowspan=e-i)}}(n),n},r=function(t){var i={};return t.rows.forEach(function(t){t.cols.forEach(function(t){i[t.rowIndex+"_"+t.colIndex]=jQuery.extend({},t)})}),i},s=function(t){for(var i={rows:[]},e=0,n=t.length;n>e;e++){var o=t[e];i.rows[e]={cols:[]};for(var a=0,l=0,r=o.length;r>l&&!(a>this.columns.length);l++){var s=o[l].colspan||1;o[l].label||o[l].key?i.rows[e].cols.push({colspan:s,rowspan:1,colIndex:a,columnAttr:"sum",align:o[l].align,label:o[l].label,key:o[l].key,collector:o[l].collector,formatter:o[l].formatter}):i.rows[e].cols.push({colIndex:a,colspan:s,rowspan:1,label:"&nbsp;"}),a+=s}if(a-=1,a<this.columns.length+1)for(var l=a;l<this.columns.length+1;l++)i.rows[e].cols.push({colIndex:l+1,colspan:1,rowspan:1,label:"&nbsp;"})}return i},d=function(t){var i={rows:[]},e=0;i.rows[e]={cols:[]};for(var n=0,o=0,a=t.length;a>o&&!(n>this.columns.length);o++){var l=t[o].colspan||1;t[o].label||t[o].key?i.rows[e].cols.push({colspan:l,rowspan:1,rowIndex:0,colIndex:n,columnAttr:"default",align:t[o].align,label:t[o].label,key:t[o].key,collector:t[o].collector,formatter:t[o].formatter}):i.rows[e].cols.push({rowIndex:0,colIndex:n,colspan:l,rowspan:1,label:"&nbsp;"}),n+=l}if(n-=1,n<this.columns.length+1)for(var o=n;o<this.columns.length+1;o++)i.rows[e].cols.push({rowIndex:0,colIndex:o+1,colspan:1,rowspan:1,label:"&nbsp;"});return i};t.util={divideTableByFrozenColumnIndex:e,getMousePosition:n,ENM:o,makeHeaderTable:a,makeBodyRowTable:l,makeBodyRowMap:r,makeFootSumTable:s,makeBodyGroupingTable:d}}();