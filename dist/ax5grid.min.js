"use strict";!function(t,i){var e,a=ax5.util,o=function(){var o;i&&i.call(this),this.name="ax5grid",this.version="0.0.2",this.config={clickEventName:"click",theme:"default",animateTime:250,frozenColumnIndex:0,frozenRowIndex:0,rightSum:!1,footSum:!1,showLineNumber:!1,showRowSelector:!1,height:400,columnMinWidth:100,header:{columnHeight:23},body:{columnHeight:23}},this.colGroup=[],this.data=[],o=this.config;var n=function(t){var i={rows:[]},e=0,a=function n(t,a,d){for(var r={cols:[]},s=0,l=t.length;l>s;s++){var h=t[s],c=1;h.hidden||(h.colspan=1,h.rowspan=1,h.rowIndex=a,h.colIndex=function(){return d?(e=d.colIndex+s+1,d.colIndex+s):e++}(),r.cols.push(h),"columns"in h?c=n(h.columns,a+1,h):h.width="width"in h?h.width:o.columnMinWidth,h.colspan=c)}return r.cols.length>0?(i.rows[a]||(i.rows[a]={cols:[]}),i.rows[a].cols=i.rows[a].cols.concat(r.cols),r.cols.length-1+c):c};return a(t,0),function(){for(var t=0,e=i.rows.length;e>t;t++)for(var a=i.rows[t],o=0,n=a.cols.length;n>o;o++){var d=a.cols[o];"columns"in d||(d.rowspan=e-t)}}(),i},d=function(){var t={instanceId:this.id};return this.$target.html(e.tmpl.get("main",t)),this.$={container:{root:this.$target.find('[data-ax5grid-container="root"]'),header:this.$target.find('[data-ax5grid-container="header"]'),body:this.$target.find('[data-ax5grid-container="body"]')},panel:{"aside-header":this.$target.find('[data-ax5grid-panel="aside-header"]'),"left-header":this.$target.find('[data-ax5grid-panel="left-header"]'),header:this.$target.find('[data-ax5grid-panel="header"]'),"right-header":this.$target.find('[data-ax5grid-panel="right-header"]'),"top-aside-body":this.$target.find('[data-ax5grid-panel="top-aside-body"]'),"top-left-body":this.$target.find('[data-ax5grid-panel="top-left-body"]'),"top-body":this.$target.find('[data-ax5grid-panel="top-body"]'),"top-right-body":this.$target.find('[data-ax5grid-panel="rop-right-body"]'),"aside-body":this.$target.find('[data-ax5grid-panel="aside-body"]'),"left-body":this.$target.find('[data-ax5grid-panel="left-body"]'),body:this.$target.find('[data-ax5grid-panel="body"]'),"right-body":this.$target.find('[data-ax5grid-panel="right-body"]'),"bottom-aside-body":this.$target.find('[data-ax5grid-panel="bottom-aside-body"]'),"bottom-left-body":this.$target.find('[data-ax5grid-panel="bottom-left-body"]'),"bottom-body":this.$target.find('[data-ax5grid-panel="bottom-body"]'),"bottom-right-body":this.$target.find('[data-ax5grid-panel="bottom-right-body"]')}},this.$.container.root.css({height:o.height}),this},r=function(t){this.columns=a.deepCopy(t),this.headerTable=n.call(this,this.columns);for(var i={},e=0,o=this.headerTable.rows.length;o>e;e++)for(var d=this.headerTable.rows[e],r=0,s=d.cols.length;s>r;r++)i[d.cols[r].colIndex]=jQuery.extend({},d.cols[r]);this.colGroup=[];for(var l in i)this.colGroup.push(i[l]);return this},s=function(t){var i=(this.$.container.root.width(),this.$.container.root.height()),e=this.headerTable.rows.length*o.header.columnHeight,a=e;this.$.container.header.css({height:e}),this.$.container.body.css({height:i-e}),this.$.panel["aside-header"].css({height:a}),this.$.panel["left-header"].css({height:a}),this.$.panel.header.css({height:a}),this.$.panel["right-header"].css({height:a}),this.$.panel["top-aside-body"].hide(),this.$.panel["aside-body"].hide(),this.$.panel["bottom-aside-body"].hide(),0==o.frozenRowIndex&&(this.$.panel["top-left-body"].hide(),this.$.panel["top-body"].hide(),this.$.panel["top-right-body"].hide()),0==o.frozenColumnIndex&&this.$.panel["left-body"].hide(),this.$.panel.body.css({height:i-e}),o.rightSum||this.$.panel["right-body"].hide(),o.footSum||(this.$.panel["bottom-left-body"].hide(),this.$.panel["bottom-body"].hide(),this.$.panel["bottom-right-body"].hide())};this.init=function(t){this.onStateChanged=o.onStateChanged,this.onClick=o.onClick;var i=this.gridConfig=jQuery.extend(!0,{},o,t);return i.target?(this.$target=jQuery(i.target),this.id||(this.id=this.$target.data("data-ax5grid-id")),this.id||(this.id="ax5grid-"+ax5.getGuid(),this.$target.data("data-ax5grid-id",i.id)),function(t){a.isObject(t)&&!t.error&&(i=jQuery.extend(!0,i,t))}(a.parseJson(this.$target.attr("data-ax5grid-config"),!0)),d.call(this),r.call(this,i.columns),e.header.init.call(this),e.header.repaint.call(this),e.body.init.call(this),e.body.repaint.call(this),s.call(this,!0),this):(console.log(ax5.info.getError("ax5grid","401","init")),this)},this.align=function(){return s.call(this),this},this.setData=function(t){return e.data.set.call(this,t),e.body.repaint.call(this),this},this.main=function(){t.grid_instance=t.grid_instance||[],t.grid_instance.push(this),arguments&&a.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};e=t.grid=function(){return a.isFunction(i)&&(o.prototype=new i),o}()}(ax5.ui,ax5.ui.root),function(t){var i=function(){this.bodyRowTable={},this.leftBodyRowData={},this.bodyRowData={},this.rightBodyRowData={},this.bodyRowTable=e.call(this,this.columns)},e=function(t){var i={rows:[]},e=0,a=function o(t,a,n){for(var d={cols:[]},r=0,s=t.length,l=(function g(t){for(var i=0,r=t.length;r>i;i++){var s=t[i],l=1;s.hidden||("key"in s?(s.colspan=1,s.rowspan=1,s.rowIndex=a,s.colIndex=function(){return n?(e=n.colIndex+i+1,n.colIndex+i):e++}(),d.cols.push(s),"columns"in s&&(l=o(s.columns,a+1,s)),s.colspan=l):"columns"in s&&g(s.columns,a))}});s>r;r++){var h=t[r],c=1;h.hidden||("key"in h?(h.colspan=1,h.rowspan=1,h.rowIndex=a,h.colIndex=function(){return n?(e=n.colIndex+r+1,n.colIndex+r):e++}(),d.cols.push(h),"columns"in h&&(c=o(h.columns,a+1,h)),h.colspan=c):"columns"in h&&l(h.columns,a))}return d.cols.length>0?(i.rows[a]||(i.rows[a]={cols:[]}),i.rows[a].cols=i.rows[a].cols.concat(d.cols),d.cols.length-1+c):c};return a(t,0),function(){for(var t=0,e=i.rows.length;e>t;t++)for(var a=i.rows[t],o=0,n=a.cols.length;n>o;o++){var d=a.cols[o];"columns"in d||(d.rowspan=e-t)}}(),i},a=function(){var i=this.config,e=t.util.divideTableByFrozenColumnIndex(this.bodyRowTable,this.config.frozenColumnIndex),a=this.leftBodyRowData=e.leftData,o=this.bodyRowData=e.rightData,n=this.data,d=function(t,e,a,o){var n=[];n.push('<table border="0" cellpadding="0" cellspacing="0">'),n.push("<colgroup>");for(var d=0,r=e.length;r>d;d++)n.push('<col style="width:'+e[d]._realWidth+';"  />');n.push("</colgroup>");for(var s=0,l=o.length;l>s;s++)for(var h=0,c=a.rows.length;c>h;h++){n.push('<tr style="height: '+i.body.columnHeight+'px;">');for(var g=0,u=a.rows[h].cols.length;u>g;g++){var p=a.rows[h].cols[g],f=i.body.columnHeight*p.rowspan;n.push('<td colspan="'+p.colspan+'" rowspan="'+p.rowspan+'" style="line-height: '+i.body.columnHeight+'px;min-height: 1px;">'),n.push('<div data-ax5grid-cellBG="" style="height:'+f+'px;"></div>'),n.push('<span data-ax5grid-cellHolder="" style="">',o[s][p.key]||"&nbsp;","</span>"),n.push("</td>")}n.push("</tr>")}n.push("</table>"),t.html(n.join(""))};i.frozenColumnIndex>0&&d(this.$.panel["left-body"],this.leftHeaderColGroup,a,n),d(this.$.panel.body,this.headerColGroup,o,n),i.rightSum},o=function(){var i=t.util.divideTableByFrozenColumnIndex(this.bodyRowTable,this.config.frozenColumnIndex),e=this.leftBodyRowData=i.leftData,a=this.bodyRowData=i.rightData,o=this.data,n=function(){for(var t=this.cols.length;t--;)this.cols[t]["@dataIndex"]=this["@dataIndex"];return this.cols},d=function(){return{value:o[this["@dataIndex"]][this.key]||"&nbsp;"}};this.config.frozenColumnIndex>0&&this.$.panel["left-body"].html(t.tmpl.get("body",{list:o,"@rows":function(){for(var t=e.rows.length;t--;)e.rows[t]["@dataIndex"]=this["@i"];return e.rows},"@cols":n,"@columnValue":d})),this.$.panel.body.html(t.tmpl.get("body",{list:o,"@rows":function(){for(var t=a.rows.length;t--;)a.rows[t]["@dataIndex"]=this["@i"];return a.rows},"@cols":n,"@columnValue":d}))},n=function(){};t.body={init:i,repaint:a,repaintByTmpl:o,setData:n}}(ax5.ui.grid),function(t){var i=ax5.util,e=function(){},a=function(t){return this.data=i.deepCopy(t),this},o=function(){};t.data={init:e,set:a,get:o}}(ax5.ui.grid),function(t){var i=function(){this.leftHeaderData={},this.headerData={},this.rightHeaderData={}},e=function(){var i=t.util.divideTableByFrozenColumnIndex(this.headerTable,this.config.frozenColumnIndex);this.leftHeaderData=i.leftData,this.headerData=i.rightData,this.leftHeaderColGroup=this.colGroup.slice(0,this.config.frozenColumnIndex),this.headerColGroup=this.colGroup.slice(this.config.frozenColumnIndex);var e=this.config,a=function(){return ax5.util.isNumber(this.width)?(this._realWidth=this.width+"px",this._realWidth):(this._realWidth=void 0,"")},o=function(){return e.header.columnHeight+"px"},n=function(){return"height:"+e.header.columnHeight*this.rowspan+"px"};this.config.frozenColumnIndex>0&&this.$.panel["left-header"].html(t.tmpl.get("header",{"@getColWidth":a,"@getRowHeight":o,"@getColStyle":n,colGroup:this.leftHeaderColGroup,table:this.leftHeaderData})),this.$.panel.header.html(t.tmpl.get("header",{"@getColWidth":a,"@getRowHeight":o,"@getColStyle":n,colGroup:this.headerColGroup,table:this.headerData})),this.config.rightSum&&this.$.panel["right-header"].html(t.tmpl.get("header",{"@getColWidth":a,"@getRowHeight":o,"@getColStyle":n,table:this.rightHeaderData}))};t.header={init:i,repaint:e}}(ax5.ui.grid),function(t){var i=function(){};t.scroller={init:i}}(ax5.ui.grid),function(t){var i='<div data-ax5grid-container="root" data-ax5grid-instance="{{instanceId}}">\n            <div data-ax5grid-container="header">\n                <div data-ax5grid-panel="aside-header"></div>\n                <div data-ax5grid-panel="left-header"></div>\n                <div data-ax5grid-panel="header"></div>\n                <div data-ax5grid-panel="right-header"></div>\n            </div>\n            <div data-ax5grid-container="body">\n                <div data-ax5grid-panel="top-aside-body"></div>\n                <div data-ax5grid-panel="top-left-body"></div>\n                <div data-ax5grid-panel="top-body"></div>\n                <div data-ax5grid-panel="top-right-body"></div>\n                <div data-ax5grid-panel="aside-body"></div>\n                <div data-ax5grid-panel="left-body"></div>\n                <div data-ax5grid-panel="body"></div>\n                <div data-ax5grid-panel="right-body"></div>\n                <div data-ax5grid-panel="bottom-aside-body"></div>\n                <div data-ax5grid-panel="bottom-left-body"></div>\n                <div data-ax5grid-panel="bottom-body"></div>\n                <div data-ax5grid-panel="bottom-right-body"></div>\n            </div>\n        </div>',e='<table border="0" cellpadding="0" cellspacing="0">\n            <colgroup>\n            {{#colGroup}}<col style="width:{{@getColWidth}};" />{{/colGroup}}\n            </colgroup>\n            {{#table.rows}} \n            <tr style="height:{{@getRowHeight}};">\n                {{#cols}}\n                <td colspan="{{colspan}}" rowspan="{{rowspan}}">\n                    <div data-ax5grid-cellBG="" style="{{@getColStyle}}"></div>\n                    <span data-ax5grid-cellHolder="">{{{label}}}</span>\n                </td>\n                {{/cols}}\n            </tr>\n            {{/table.rows}}\n        </table>\n        ';t.tmpl={main:i,header:e,get:function(i,e){return ax5.mustache.render(t.tmpl[i],e)}}}(ax5.ui.grid),function(t){var i=function(t,i){for(var e={rows:[]},a={rows:[]},o=0,n=t.rows.length;n>o;o++){var d=t.rows[o];e.rows[o]={cols:[]},a.rows[o]={cols:[]};for(var r=0,s=d.cols.length;s>r;r++){var l=jQuery.extend({},d.cols[r]),h=l.colIndex,c=l.colIndex+l.colspan;if(i>h)if(i>=c)e.rows[o].cols.push(l);else{var g=jQuery.extend({},l),u=jQuery.extend({},g);g.colspan=i-g.colIndex,u.colIndex=i,u.colspan=l.colspan-g.colspan,e.rows[o].cols.push(g),a.rows[o].cols.push(u)}else a.rows[o].cols.push(l)}}return{leftData:e,rightData:a}};t.util={divideTableByFrozenColumnIndex:i}}(ax5.ui.grid);