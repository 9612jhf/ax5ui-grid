"use strict";!function(t,i){var a,e=ax5.util,o=function(){var o;i&&i.call(this),this.name="ax5grid",this.version="0.0.2",this.config={clickEventName:"click",theme:"default",animateTime:250,frozenColumnIndex:0,frozenRowIndex:0,rightSum:!1,footSum:!1,showLineNumber:!1,showRowSelector:!1,height:400,columnMinWidth:100,asideColumnWidth:30,header:{columnHeight:23,columnPadding:3,columnBorderWidth:1},body:{columnHeight:23,columnPadding:3,columnBorderWidth:1}},this.colGroup=[],this.data=[],o=this.config;var n=function(t){var i={rows:[]},a=0,e=function n(t,e,d){for(var r={cols:[]},l=0,h=t.length;h>l;l++){var s=t[l],c=1;s.hidden||(s.colspan=1,s.rowspan=1,s.rowIndex=e,s.colIndex=function(){return d?(a=d.colIndex+l+1,d.colIndex+l):a++}(),r.cols.push(s),"columns"in s?c=n(s.columns,e+1,s):s.width="width"in s?s.width:o.columnMinWidth,s.colspan=c)}return r.cols.length>0?(i.rows[e]||(i.rows[e]={cols:[]}),i.rows[e].cols=i.rows[e].cols.concat(r.cols),r.cols.length-1+c):c};return e(t,0),function(){for(var t=0,a=i.rows.length;a>t;t++)for(var e=i.rows[t],o=0,n=e.cols.length;n>o;o++){var d=e.cols[o];"columns"in d||(d.rowspan=a-t)}}(),i},d=function(){var t={instanceId:this.id};return this.$target.html(a.tmpl.get("main",t)),this.$={container:{root:this.$target.find('[data-ax5grid-container="root"]'),header:this.$target.find('[data-ax5grid-container="header"]'),body:this.$target.find('[data-ax5grid-container="body"]')},panel:{"aside-header":this.$target.find('[data-ax5grid-panel="aside-header"]'),"left-header":this.$target.find('[data-ax5grid-panel="left-header"]'),header:this.$target.find('[data-ax5grid-panel="header"]'),"right-header":this.$target.find('[data-ax5grid-panel="right-header"]'),"top-aside-body":this.$target.find('[data-ax5grid-panel="top-aside-body"]'),"top-left-body":this.$target.find('[data-ax5grid-panel="top-left-body"]'),"top-body":this.$target.find('[data-ax5grid-panel="top-body"]'),"top-right-body":this.$target.find('[data-ax5grid-panel="top-right-body"]'),"aside-body":this.$target.find('[data-ax5grid-panel="aside-body"]'),"left-body":this.$target.find('[data-ax5grid-panel="left-body"]'),body:this.$target.find('[data-ax5grid-panel="body"]'),"right-body":this.$target.find('[data-ax5grid-panel="right-body"]'),"bottom-aside-body":this.$target.find('[data-ax5grid-panel="bottom-aside-body"]'),"bottom-left-body":this.$target.find('[data-ax5grid-panel="bottom-left-body"]'),"bottom-body":this.$target.find('[data-ax5grid-panel="bottom-body"]'),"bottom-right-body":this.$target.find('[data-ax5grid-panel="bottom-right-body"]')}},this.$.container.root.css({height:o.height}),this},r=function(t){this.columns=e.deepCopy(t),this.headerTable=n.call(this,this.columns);for(var i={},a=0,o=this.headerTable.rows.length;o>a;a++)for(var d=this.headerTable.rows[a],r=0,l=d.cols.length;l>r;r++)i[d.cols[r].colIndex]=jQuery.extend({},d.cols[r]);this.colGroup=[];for(var h in i)this.colGroup.push(i[h]);return this},l=function(){for(var t,i=this.$.container.root.width(),a=0,o=[],n=this.colGroup,d=0,r=n.length;r>d;d++)e.isNumber(n[d].width)?a+=n[d]._width=n[d].width:"*"===n[d].width?o.push(d):"%"===e.right(n[d].width,1)&&(a+=n[d]._width=i*e.left(n[d].width,"%")/100);if(o.length>0){t=(i-a)/o.length;for(var d=0,r=o.length;r>d;d++)n[o[d]]._width=t}},h=function(t){var i=this.$.container.root.width(),a=this.$.container.root.height(),e=function(){var t=0;return o.showLineNumber&&(t+=o.asideColumnWidth),o.showRowSelector&&(t+=o.asideColumnWidth),t}(),n=function(t,i){for(var a=0,e=0,o=i;o>e;e++)a+=t[e]._width;return a}(this.colGroup,o.frozenColumnIndex),d=0,r=0,l=0,h=this.headerTable.rows.length*o.header.columnHeight,s=a-h,c=function(t,a,h,c){var u={},g=!1;switch(h){case"aside":0===e?(t.hide(),g=!0):u.width=e;break;case"left":0===o.frozenColumnIndex?(t.hide(),g=!0):(u.left=0,u.width=n);break;case"right":o.rightSum||(t.hide(),g=!0);break;default:0===o.frozenColumnIndex?(u.left=0,u.width=i-d):(u.left=n,u.width=i-d-n)}if(g)return this;if("body"===c)switch(a){case"top":0===o.frozenRowIndex?(t.hide(),g=!0):(u.top=0,u.height=r);break;case"bottom":o.footSum?(u.top=s-l,u.height=l):(t.hide(),g=!0);break;default:u.top=0,u.height=s,0===o.frozenRowIndex&&(u.top=r,u.height=s-r),o.footSum&&(u.height-=l)}return g?this:(t.css(u),this)};this.$.container.header.css({height:h}),this.$.container.body.css({height:s}),c.call(this,this.$.panel["aside-header"],"","aside","header"),c.call(this,this.$.panel["left-header"],"","left","header"),c.call(this,this.$.panel.header,"","","header"),c.call(this,this.$.panel["right-header"],"","right","header"),c.call(this,this.$.panel["top-aside-body"],"top","aside","body"),c.call(this,this.$.panel["top-left-body"],"top","left","body"),c.call(this,this.$.panel["top-body"],"top","","body"),c.call(this,this.$.panel["top-right-body"],"top","right","body"),c.call(this,this.$.panel["aside-body"],"","aside","body"),c.call(this,this.$.panel["left-body"],"","left","body"),c.call(this,this.$.panel.body,"","","body"),c.call(this,this.$.panel["right-body"],"","right","body"),c.call(this,this.$.panel["bottom-aside-body"],"bottom","aside","body"),c.call(this,this.$.panel["bottom-left-body"],"bottom","left","body"),c.call(this,this.$.panel["bottom-body"],"bottom","","body"),c.call(this,this.$.panel["bottom-right-body"],"bottom","right","body")};this.init=function(t){this.onStateChanged=o.onStateChanged,this.onClick=o.onClick;var i=this.gridConfig=jQuery.extend(!0,{},o,t);return i.target?(this.$target=jQuery(i.target),this.id||(this.id=this.$target.data("data-ax5grid-id")),this.id||(this.id="ax5grid-"+ax5.getGuid(),this.$target.data("data-ax5grid-id",i.id)),function(t){e.isObject(t)&&!t.error&&(i=jQuery.extend(!0,i,t))}(e.parseJson(this.$target.attr("data-ax5grid-config"),!0)),d.call(this),r.call(this,i.columns),l.call(this),a.header.init.call(this),a.header.repaint.call(this),a.body.init.call(this),a.body.repaint.call(this),h.call(this,!0),this):(console.log(ax5.info.getError("ax5grid","401","init")),this)},this.align=function(){return h.call(this),this},this.setData=function(t){return a.data.set.call(this,t),a.body.repaint.call(this),this},this.main=function(){t.grid_instance=t.grid_instance||[],t.grid_instance.push(this),arguments&&e.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};a=t.grid=function(){return e.isFunction(i)&&(o.prototype=new i),o}()}(ax5.ui,ax5.ui.root),function(t){var i=function(){this.bodyRowTable={},this.leftBodyRowData={},this.bodyRowData={},this.rightBodyRowData={},this.bodyRowTable=a.call(this,this.columns)},a=function(t){var i={rows:[]},a=0,e=function o(t,e,n){for(var d={cols:[]},r=0,l=t.length,h=(function u(t){for(var i=0,r=t.length;r>i;i++){var l=t[i],h=1;l.hidden||("key"in l?(l.colspan=1,l.rowspan=1,l.rowIndex=e,l.colIndex=function(){return n?(a=n.colIndex+i+1,n.colIndex+i):a++}(),d.cols.push(l),"columns"in l&&(h=o(l.columns,e+1,l)),l.colspan=h):"columns"in l&&u(l.columns,e))}});l>r;r++){var s=t[r],c=1;s.hidden||("key"in s?(s.colspan=1,s.rowspan=1,s.rowIndex=e,s.colIndex=function(){return n?(a=n.colIndex+r+1,n.colIndex+r):a++}(),d.cols.push(s),"columns"in s&&(c=o(s.columns,e+1,s)),s.colspan=c):"columns"in s&&h(s.columns,e))}return d.cols.length>0?(i.rows[e]||(i.rows[e]={cols:[]}),i.rows[e].cols=i.rows[e].cols.concat(d.cols),d.cols.length-1+c):c};return e(t,0),function(){for(var t=0,a=i.rows.length;a>t;t++)for(var e=i.rows[t],o=0,n=e.cols.length;n>o;o++){var d=e.cols[o];"columns"in d||(d.rowspan=a-t)}}(),i},e=function(){var i=this.config,a=t.util.divideTableByFrozenColumnIndex(this.bodyRowTable,this.config.frozenColumnIndex),e=this.leftBodyRowData=a.leftData,o=this.bodyRowData=a.rightData,n=this.data,d=function(t,a,e,o){var n=[];n.push('<table border="0" cellpadding="0" cellspacing="0">'),n.push("<colgroup>");for(var d=0,r=a.length;r>d;d++)n.push('<col style="width:'+a[d]._width+'px;"  />');n.push("<col  />"),n.push("</colgroup>");for(var l=0,h=o.length;h>l;l++)for(var s=0,c=e.rows.length;c>s;s++){n.push('<tr class="tr-'+l%4+'">');for(var u=0,g=e.rows[s].cols.length;g>u;u++){var p=e.rows[s].cols[u],f=i.body.columnHeight*p.rowspan-i.body.columnBorderWidth,b="";i.body.columnBorderWidth&&(b+="hasBorder "),u==g-1&&(b+="isLastColumn "),n.push("<td ",'data-ax5grid-column-row="'+s+'" ','data-ax5grid-column-col="'+u+'" ','colspan="'+p.colspan+'" rowspan="'+p.rowspan+'" ','class="'+b+'" ','style="height: '+f+'px;min-height: 1px;">'),n.push(function(){var t=i.body.columnHeight-2*i.body.columnPadding-i.body.columnBorderWidth;return p.multiLine?'<span data-ax5grid-cellHolder="multiLine" style="height:'+f+"px;line-height: "+t+'px;">':'<span data-ax5grid-cellHolder="" style="height: '+(i.body.columnHeight-i.body.columnBorderWidth)+"px;line-height: "+t+'px;">'}(),o[l][p.key]||"&nbsp;","</span>"),n.push("</td>")}n.push("<td ",'data-ax5grid-column-row="null" ','data-ax5grid-column-col="null" ','data-ax5grid-data-index="'+l+'" ','style="height: '+i.body.columnHeight+'px;min-height: 1px;" ',"></td>"),n.push("</tr>")}n.push("</table>"),t.html(n.join(""))};i.frozenColumnIndex>0&&d(this.$.panel["left-body"],this.leftHeaderColGroup,e,n),d(this.$.panel.body,this.headerColGroup,o,n),i.rightSum},o=function(){};t.body={init:i,repaint:e,setData:o}}(ax5.ui.grid),function(t){var i=ax5.util,a=function(){},e=function(t){return this.data=i.deepCopy(t),this},o=function(){};t.data={init:a,set:e,get:o}}(ax5.ui.grid),function(t){var i=function(){this.leftHeaderData={},this.headerData={},this.rightHeaderData={}},a=function(){var i=this.config,a=t.util.divideTableByFrozenColumnIndex(this.headerTable,this.config.frozenColumnIndex),e=this.leftHeaderData=a.leftData,o=this.headerData=a.rightData;this.leftHeaderColGroup=this.colGroup.slice(0,this.config.frozenColumnIndex),this.headerColGroup=this.colGroup.slice(this.config.frozenColumnIndex);var n=function(t,a,e){var o=[];o.push('<table border="0" cellpadding="0" cellspacing="0">'),o.push("<colgroup>");for(var n=0,d=a.length;d>n;n++)o.push('<col style="width:'+a[n]._width+'px;"  />');o.push("<col  />"),o.push("</colgroup>");for(var r=0,l=e.rows.length;l>r;r++){var h="";o.push('<tr class="'+h+'">');for(var s=0,c=e.rows[r].cols.length;c>s;s++){var u=e.rows[r].cols[s],g=i.header.columnHeight*u.rowspan-i.header.columnBorderWidth,p="";i.header.columnBorderWidth&&(p+="hasBorder "),s==c-1&&(p+="isLastColumn "),o.push("<td ",'data-ax5grid-column-row="'+r+'" ','data-ax5grid-column-col="'+s+'" ','colspan="'+u.colspan+'" rowspan="'+u.rowspan+'" ','class="'+p+'" ','style="height: '+g+'px;min-height: 1px;">'),o.push(function(){var t=i.header.columnHeight-2*i.header.columnPadding-i.header.columnBorderWidth;return u.multiLine?'<span data-ax5grid-cellHolder="multiLine" style="height:'+g+"px;line-height: "+t+'px;">':'<span data-ax5grid-cellHolder="" style="height: '+(i.header.columnHeight-i.header.columnBorderWidth)+"px;line-height: "+t+'px;">'}(),u.label||"&nbsp;","</span>"),o.push("</td>")}o.push("<td ",'data-ax5grid-column-row="null" ','data-ax5grid-column-col="null" ','style="height: '+i.header.columnHeight+'px;min-height: 1px;" ',"></td>"),o.push("</tr>")}o.push("</table>"),t.html(o.join(""))};i.frozenColumnIndex>0&&n(this.$.panel["left-header"],this.leftHeaderColGroup,e),n(this.$.panel.header,this.headerColGroup,o),i.rightSum};t.header={init:i,repaint:a}}(ax5.ui.grid),function(t){var i=function(){};t.scroller={init:i}}(ax5.ui.grid),function(t){var i='<div data-ax5grid-container="root" data-ax5grid-instance="{{instanceId}}">\n            <div data-ax5grid-container="header">\n                <div data-ax5grid-panel="aside-header"></div>\n                <div data-ax5grid-panel="left-header"></div>\n                <div data-ax5grid-panel="header"></div>\n                <div data-ax5grid-panel="right-header"></div>\n            </div>\n            <div data-ax5grid-container="body">\n                <div data-ax5grid-panel="top-aside-body"></div>\n                <div data-ax5grid-panel="top-left-body"></div>\n                <div data-ax5grid-panel="top-body"></div>\n                <div data-ax5grid-panel="top-right-body"></div>\n                <div data-ax5grid-panel="aside-body"></div>\n                <div data-ax5grid-panel="left-body"></div>\n                <div data-ax5grid-panel="body"></div>\n                <div data-ax5grid-panel="right-body"></div>\n                <div data-ax5grid-panel="bottom-aside-body"></div>\n                <div data-ax5grid-panel="bottom-left-body"></div>\n                <div data-ax5grid-panel="bottom-body"></div>\n                <div data-ax5grid-panel="bottom-right-body"></div>\n            </div>\n        </div>';t.tmpl={main:i,get:function(i,a){return ax5.mustache.render(t.tmpl[i],a)}}}(ax5.ui.grid),function(t){var i=function(t,i){for(var a={rows:[]},e={rows:[]},o=0,n=t.rows.length;n>o;o++){var d=t.rows[o];a.rows[o]={cols:[]},e.rows[o]={cols:[]};for(var r=0,l=d.cols.length;l>r;r++){var h=jQuery.extend({},d.cols[r]),s=h.colIndex,c=h.colIndex+h.colspan;if(i>s)if(i>=c)a.rows[o].cols.push(h);else{var u=jQuery.extend({},h),g=jQuery.extend({},u);u.colspan=i-u.colIndex,g.colIndex=i,g.colspan=h.colspan-u.colspan,a.rows[o].cols.push(u),e.rows[o].cols.push(g)}else e.rows[o].cols.push(h)}}return{leftData:a,rightData:e}};t.util={divideTableByFrozenColumnIndex:i}}(ax5.ui.grid);